<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 1: Abbreviations - The Canadian Style</title>
    <link rel="stylesheet" href="../shared/css/main.css">
    <link rel="stylesheet" href="../shared/css/quiz-styles.css">
</head>
<body>
    <div class="chapter-container">
        <header class="chapter-header">
            <div class="breadcrumb">
                <a href="../index.html" class="breadcrumb-link">‚Üê Dashboard</a>
                <span class="breadcrumb-separator">/</span>
                <span class="breadcrumb-current">Chapter 1: Abbreviations</span>
            </div>
            <div class="chapter-progress">
                <div class="progress-bar">
                    <div class="progress-fill" id="chapterProgress"></div>
                </div>
                <span class="progress-text">Progress</span>
            </div>
        </header>

        <nav class="chapter-nav">
            <div class="nav-links">
                <a href="#introduction" class="tab-link active" data-section="introduction">1.01 Introduction</a>
                <a href="#sentence-capitals" class="tab-link" data-section="sentence-capitals">1.02 Sentence Capitals</a>
                <a href="#proper-nouns" class="tab-link" data-section="proper-nouns">1.03 Proper Nouns</a>
                <a href="#government-bodies" class="tab-link" data-section="government-bodies">1.04 Government Bodies</a>
                <a href="#titles-positions" class="tab-link" data-section="titles-positions">1.05 Titles & Positions</a>
                <a href="#geographic-names" class="tab-link" data-section="geographic-names">1.06 Geographic Names</a>
                <a href="#brand-names" class="tab-link" data-section="brand-names">1.07 Brand Names</a>
                <a href="#academic-degrees" class="tab-link" data-section="academic-degrees">1.08 Academic Degrees</a>
            </div>
        </nav>

        <main class="chapter-content">
            <!-- Introduction Section -->
            <section class="content-section" id="introduction">
                <div class="section-header">
                    <h2>1.01 Introduction to Abbreviations</h2>
                </div>
                
                <div class="content-block">
                    <p>Abbreviations save space and time in writing, but they must be used carefully to maintain clarity. This chapter covers Canadian government standards for creating and using abbreviations effectively.</p>
                    
                    <div class="key-principles">
                        <h3>General Principles</h3>
                        <ul>
                            <li>Use abbreviations sparingly in formal writing</li>
                            <li>Define abbreviations on first use</li>
                            <li>Avoid abbreviations that might confuse readers</li>
                            <li>Follow established conventions consistently</li>
                        </ul>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Common Patterns</h4>
                            <ul>
                                <li><strong>Periods:</strong> Mr., Dr., etc.</li>
                                <li><strong>No periods:</strong> UN, NATO, CEO</li>
                                <li><strong>Mixed:</strong> Ph.D., LL.B.</li>
                                <li><strong>Metric:</strong> km, kg, cm (no periods)</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>First Use Rule</h4>
                            <ul>
                                <li>First: "Department of Justice (DOJ)"</li>
                                <li>Later: "DOJ announced..."</li>
                                <li>First: "gross domestic product (GDP)"</li>
                                <li>Later: "GDP increased by 2%"</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Panel for Introduction -->
                <div class="quiz-panel" id="quiz-introduction"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('introduction')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Sentence Capitals Section -->
            <section class="content-section" id="sentence-capitals" style="display: none;">
                <div class="section-header">
                    <h2>1.02 Sentence Capitals</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Basic Rule</h4>
                        <p>Abbreviations at the beginning of sentences follow normal capitalization rules, regardless of how they appear mid-sentence.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Correct Examples</h4>
                            <ul>
                                <li><strong>Mid-sentence:</strong> The e.g. used was appropriate</li>
                                <li><strong>Sentence start:</strong> E.g., this example works well</li>
                                <li><strong>Mid-sentence:</strong> The etc. at the end</li>
                                <li><strong>Sentence start:</strong> Etc. should be avoided here</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Special Cases</h4>
                            <ul>
                                <li><strong>Avoid:</strong> Starting sentences with etc.</li>
                                <li><strong>Prefer:</strong> Spell out at sentence start when unclear</li>
                                <li><strong>Exception:</strong> Well-known abbreviations (FBI, UN)</li>
                                <li><strong>Always OK:</strong> Proper names (Mr. Smith)</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Panel for Sentence Capitals -->
                <div class="quiz-panel" id="quiz-sentence-capitals"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('sentence-capitals')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Proper Nouns Section -->
            <section class="content-section" id="proper-nouns" style="display: none;">
                <div class="section-header">
                    <h2>1.03 Proper Nouns</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Abbreviating Proper Nouns</h4>
                        <p>Proper nouns can be abbreviated using initial letters, but follow established conventions for well-known organizations.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Organizations</h4>
                            <ul>
                                <li><strong>UN</strong> (United Nations)</li>
                                <li><strong>NATO</strong> (North Atlantic Treaty Organization)</li>
                                <li><strong>WHO</strong> (World Health Organization)</li>
                                <li><strong>RCMP</strong> (Royal Canadian Mounted Police)</li>
                                <li><strong>CBC</strong> (Canadian Broadcasting Corporation)</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Geographic Names</h4>
                            <ul>
                                <li><strong>USA</strong> or <strong>U.S.</strong> (United States)</li>
                                <li><strong>UK</strong> or <strong>U.K.</strong> (United Kingdom)</li>
                                <li><strong>EU</strong> (European Union)</li>
                                <li><strong>N.B.</strong> (New Brunswick)</li>
                                <li><strong>P.E.I.</strong> (Prince Edward Island)</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Style Choices</h4>
                        <p>Canadian style generally omits periods in abbreviations of organization names, but includes them for geographic abbreviations and traditional forms.</p>
                    </div>
                </div>
                
                <!-- Quiz Panel for Proper Nouns -->
                <div class="quiz-panel" id="quiz-proper-nouns"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('proper-nouns')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Government Bodies Section -->
            <section class="content-section" id="government-bodies" style="display: none;">
                <div class="section-header">
                    <h2>1.04 Government Bodies</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Government Abbreviations</h4>
                        <p>Government departments and agencies often have standard abbreviations that should be used consistently.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Federal Departments</h4>
                            <ul>
                                <li><strong>DOJ</strong> (Department of Justice)</li>
                                <li><strong>DND</strong> (Department of National Defence)</li>
                                <li><strong>DFAIT</strong> (Foreign Affairs & International Trade)</li>
                                <li><strong>HC</strong> (Health Canada)</li>
                                <li><strong>CRA</strong> (Canada Revenue Agency)</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Agencies & Crown Corporations</h4>
                            <ul>
                                <li><strong>CSIS</strong> (Canadian Security Intelligence Service)</li>
                                <li><strong>CRTC</strong> (Canadian Radio-television Telecommunications Commission)</li>
                                <li><strong>NFB</strong> (National Film Board)</li>
                                <li><strong>CBC/SRC</strong> (Canadian Broadcasting Corporation)</li>
                                <li><strong>VIA</strong> (VIA Rail Canada)</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Usage Guidelines</h4>
                        <ul>
                            <li>Always define on first use in documents</li>
                            <li>Use the organization's preferred abbreviation</li>
                            <li>Be consistent throughout the document</li>
                            <li>Avoid creating new abbreviations for one-time use</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Quiz Panel for Government Bodies -->
                <div class="quiz-panel" id="quiz-government-bodies"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('government-bodies')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Titles & Positions Section -->
            <section class="content-section" id="titles-positions" style="display: none;">
                <div class="section-header">
                    <h2>1.05 Titles & Positions</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Personal Titles</h4>
                        <p>Personal titles are abbreviated when they appear before names, but spelled out when used alone.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Standard Titles</h4>
                            <ul>
                                <li><strong>Mr.</strong> (Mister)</li>
                                <li><strong>Mrs.</strong> (Missus)</li>
                                <li><strong>Ms.</strong> (Miss/Mrs.)</li>
                                <li><strong>Dr.</strong> (Doctor)</li>
                                <li><strong>Prof.</strong> (Professor)</li>
                                <li><strong>Rev.</strong> (Reverend)</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Government Positions</h4>
                            <ul>
                                <li><strong>Hon.</strong> (Honourable)</li>
                                <li><strong>Sen.</strong> (Senator)</li>
                                <li><strong>MP</strong> (Member of Parliament)</li>
                                <li><strong>MLA</strong> (Member of Legislative Assembly)</li>
                                <li><strong>MPP</strong> (Member of Provincial Parliament)</li>
                                <li><strong>MNA</strong> (Member of National Assembly)</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Before Names</h4>
                            <ul>
                                <li>Dr. Smith will attend</li>
                                <li>Hon. Jane Doe spoke</li>
                                <li>Mr. and Mrs. Brown</li>
                                <li>Sen. Wilson announced</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Used Alone</h4>
                            <ul>
                                <li>The doctor will attend</li>
                                <li>The minister spoke</li>
                                <li>Mister and missus</li>
                                <li>The senator announced</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Panel for Titles & Positions -->
                <div class="quiz-panel" id="quiz-titles-positions"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('titles-positions')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Geographic Names Section -->
            <section class="content-section" id="geographic-names" style="display: none;">
                <div class="section-header">
                    <h2>1.06 Geographic Names</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Geographic Abbreviations</h4>
                        <p>Geographic names have established abbreviations, particularly for addresses and formal references.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Canadian Provinces</h4>
                            <ul>
                                <li><strong>Alta.</strong> (Alberta)</li>
                                <li><strong>B.C.</strong> (British Columbia)</li>
                                <li><strong>Man.</strong> (Manitoba)</li>
                                <li><strong>N.B.</strong> (New Brunswick)</li>
                                <li><strong>Nfld.</strong> (Newfoundland and Labrador)</li>
                                <li><strong>N.W.T.</strong> (Northwest Territories)</li>
                                <li><strong>N.S.</strong> (Nova Scotia)</li>
                                <li><strong>Ont.</strong> (Ontario)</li>
                                <li><strong>P.E.I.</strong> (Prince Edward Island)</li>
                                <li><strong>Que.</strong> (Quebec)</li>
                                <li><strong>Sask.</strong> (Saskatchewan)</li>
                                <li><strong>Y.T.</strong> (Yukon Territory)</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Countries</h4>
                            <ul>
                                <li><strong>Can.</strong> (Canada)</li>
                                <li><strong>U.S.</strong> or <strong>USA</strong> (United States)</li>
                                <li><strong>U.K.</strong> (United Kingdom)</li>
                                <li><strong>Fr.</strong> (France)</li>
                                <li><strong>Ger.</strong> (Germany)</li>
                                <li><strong>Jpn.</strong> (Japan)</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Usage Guidelines</h4>
                        <ul>
                            <li>Use in addresses and tabular material</li>
                            <li>Spell out in running text unless space is limited</li>
                            <li>Be consistent within documents</li>
                            <li>Use postal abbreviations for mailing addresses</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Quiz Panel for Geographic Names -->
                <div class="quiz-panel" id="quiz-geographic-names"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('geographic-names')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Brand Names Section -->
            <section class="content-section" id="brand-names" style="display: none;">
                <div class="section-header">
                    <h2>1.07 Brand Names</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Commercial Abbreviations</h4>
                        <p>Brand names and commercial terms may be abbreviated, but use caution to maintain clarity and avoid trademark issues.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Business Terms</h4>
                            <ul>
                                <li><strong>Inc.</strong> (Incorporated)</li>
                                <li><strong>Ltd.</strong> (Limited)</li>
                                <li><strong>Corp.</strong> (Corporation)</li>
                                <li><strong>Co.</strong> (Company)</li>
                                <li><strong>Bros.</strong> (Brothers)</li>
                                <li><strong>Mfg.</strong> (Manufacturing)</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Technical Terms</h4>
                            <ul>
                                <li><strong>GPS</strong> (Global Positioning System)</li>
                                <li><strong>DVD</strong> (Digital Versatile Disc)</li>
                                <li><strong>CD-ROM</strong> (Compact Disc Read-Only Memory)</li>
                                <li><strong>FAQ</strong> (Frequently Asked Questions)</li>
                                <li><strong>URL</strong> (Uniform Resource Locator)</li>
                                <li><strong>CEO</strong> (Chief Executive Officer)</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Cautions</h4>
                        <ul>
                            <li>Respect company's preferred styling</li>
                            <li>Avoid creating abbreviations for brand names</li>
                            <li>Be consistent with established forms</li>
                            <li>Consider your audience's familiarity</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Quiz Panel for Brand Names -->
                <div class="quiz-panel" id="quiz-brand-names"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('brand-names')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Academic Degrees Section -->
            <section class="content-section" id="academic-degrees" style="display: none;">
                <div class="section-header">
                    <h2>1.08 Academic Degrees</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Degree Abbreviations</h4>
                        <p>Academic degrees follow specific conventions for abbreviation and punctuation.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Undergraduate Degrees</h4>
                            <ul>
                                <li><strong>B.A.</strong> (Bachelor of Arts)</li>
                                <li><strong>B.Sc.</strong> (Bachelor of Science)</li>
                                <li><strong>B.Ed.</strong> (Bachelor of Education)</li>
                                <li><strong>B.Eng.</strong> (Bachelor of Engineering)</li>
                                <li><strong>B.Comm.</strong> (Bachelor of Commerce)</li>
                                <li><strong>LL.B.</strong> (Bachelor of Laws)</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Graduate Degrees</h4>
                            <ul>
                                <li><strong>M.A.</strong> (Master of Arts)</li>
                                <li><strong>M.Sc.</strong> (Master of Science)</li>
                                <li><strong>M.Ed.</strong> (Master of Education)</li>
                                <li><strong>M.B.A.</strong> (Master of Business Administration)</li>
                                <li><strong>Ph.D.</strong> (Doctor of Philosophy)</li>
                                <li><strong>M.D.</strong> (Doctor of Medicine)</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Usage Rules</h4>
                        <ul>
                            <li>Use periods in degree abbreviations</li>
                            <li>Place after the person's name</li>
                            <li>Use title (Dr.) OR degree, not both</li>
                            <li>List highest degree only, unless relevant</li>
                        </ul>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Correct Usage</h4>
                            <ul>
                                <li>John Smith, Ph.D.</li>
                                <li>Dr. John Smith</li>
                                <li>Mary Jones, M.A., Ph.D.</li>
                                <li>Prof. David Brown</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Avoid</h4>
                            <ul>
                                <li>‚ùå Dr. John Smith, Ph.D.</li>
                                <li>‚ùå PhD (without periods)</li>
                                <li>‚ùå John Smith, B.A., M.A., Ph.D.</li>
                                <li>‚ùå Multiple lower degrees</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Panel for Academic Degrees -->
                <div class="quiz-panel" id="quiz-academic-degrees"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('academic-degrees')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Include JavaScript modules -->
    <script type="module" src="../shared/js/router.js"></script>
    <script type="module" src="../shared/js/quiz-engine.js"></script>
    <script type="module" src="../shared/js/progress.js"></script>
    <script type="module" src="../shared/js/components.js"></script>

    <script type="module">
        import { router } from '../shared/js/router.js';
        import { getChapterProgress, setProgress } from '../shared/js/progress.js';
        import { QuizEngine } from '../shared/js/quiz-engine.js';
        
        const CHAPTER_ID = 'ch01';
        const sections = [
            { id: 'introduction', title: '1.01 Introduction' },
            { id: 'sentence-capitals', title: '1.02 Sentence Capitals' },
            { id: 'proper-nouns', title: '1.03 Proper Nouns' },
            { id: 'government-bodies', title: '1.04 Government Bodies' },
            { id: 'titles-positions', title: '1.05 Titles & Positions' },
            { id: 'geographic-names', title: '1.06 Geographic Names' },
            { id: 'brand-names', title: '1.07 Brand Names' },
            { id: 'academic-degrees', title: '1.08 Academic Degrees' }
        ];
        
        // Initialize router
        router.init(CHAPTER_ID, sections);
        
        // Update progress bar using correct API
        function updateProgressBar() {
            const chapterProgress = getChapterProgress(CHAPTER_ID);
            const completed = Object.values(chapterProgress).filter(Boolean).length;
            const percentage = Math.round((completed / sections.length) * 100);
            
            const progressBar = document.getElementById('chapterProgress');
            if (progressBar) {
                progressBar.style.width = percentage + '%';
            }
        }
        
        // Mark section as complete
        window.completeSection = function(sectionId) {
            setProgress(CHAPTER_ID, sectionId, true);
            updateProgressBar();
            
            // Navigate to next section
            const currentIndex = sections.findIndex(s => s.id === sectionId);
            if (currentIndex < sections.length - 1) {
                const nextSection = sections[currentIndex + 1];
                router.navigateTo(CHAPTER_ID, nextSection.id);
            } else {
                // Chapter complete
                showCompletionModal();
            }
        };
        
        function showCompletionModal() {
            const modal = document.createElement('div');
            modal.className = 'completion-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <h3>üéâ Chapter 1 Complete!</h3>
                    <p>You've mastered abbreviation rules. Ready for the next chapter?</p>
                    <div class="modal-actions">
                        <button class="btn btn-outline" onclick="this.closest('.completion-modal').remove()">
                            Stay Here
                        </button>
                        <a href="../index.html" class="btn btn-primary">
                            Back to Dashboard
                        </a>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        // Load section quizzes - FIXED VERSION
        async function loadSectionQuizzes() {
            // Sample quiz data - in real implementation, this would come from JSON files
            const quizData = {
                introduction: {
                    title: 'Introduction to Abbreviations',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'What is the most important rule for using abbreviations?',
                            options: [
                                { label: 'Use as many as possible to save space', correct: false },
                                { label: 'Define them on first use', correct: true },
                                { label: 'Never use periods', correct: false },
                                { label: 'Only use standard ones', correct: false }
                            ],
                            rationale: 'Always define abbreviations on first use to ensure clarity for readers.',
                            ref: '¬ß1.01'
                        }
                    ]
                },
                'sentence-capitals': {
                    title: 'Sentence Capitals',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'How should "e.g." be written at the start of a sentence?',
                            options: [
                                { label: 'e.g.', correct: false },
                                { label: 'E.g.', correct: true },
                                { label: 'E.G.', correct: false },
                                { label: 'eg.', correct: false }
                            ],
                            rationale: 'Abbreviations at sentence beginnings follow normal capitalization rules.',
                            ref: '¬ß1.02'
                        }
                    ]
                },
                'proper-nouns': {
                    title: 'Proper Nouns',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'Which abbreviation style does Canadian government prefer?',
                            options: [
                                { label: 'U.N.A.T.O. (with periods)', correct: false },
                                { label: 'UN NATO (no periods)', correct: true },
                                { label: 'un nato (lowercase)', correct: false },
                                { label: 'Un Nato (mixed case)', correct: false }
                            ],
                            rationale: 'Canadian style generally omits periods in organization name abbreviations.',
                            ref: '¬ß1.03'
                        }
                    ]
                },
                'government-bodies': {
                    title: 'Government Bodies',
                    questions: [
                        {
                            type: 'fill-blank',
                            stem: 'What does DOJ stand for?',
                            answer: 'Department of Justice',
                            rationale: 'DOJ is the standard abbreviation for Department of Justice.',
                            ref: '¬ß1.04'
                        }
                    ]
                },
                'titles-positions': {
                    title: 'Titles & Positions',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'Which is correct when the title is used alone?',
                            options: [
                                { label: 'The Dr. will see you', correct: false },
                                { label: 'The doctor will see you', correct: true },
                                { label: 'The Dr will see you', correct: false },
                                { label: 'The Doctor will see you', correct: false }
                            ],
                            rationale: 'Titles are spelled out when used alone, abbreviated only before names.',
                            ref: '¬ß1.05'
                        }
                    ]
                },
                'geographic-names': {
                    title: 'Geographic Names',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'What is the correct abbreviation for British Columbia?',
                            options: [
                                { label: 'BC', correct: false },
                                { label: 'B.C.', correct: true },
                                { label: 'Bc', correct: false },
                                { label: 'B-C', correct: false }
                            ],
                            rationale: 'Canadian provincial abbreviations use periods: B.C., N.B., P.E.I.',
                            ref: '¬ß1.06'
                        }
                    ]
                },
                'brand-names': {
                    title: 'Brand Names',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'Which business abbreviation uses periods?',
                            options: [
                                { label: 'CEO', correct: false },
                                { label: 'Inc.', correct: true },
                                { label: 'FAQ', correct: false },
                                { label: 'GPS', correct: false }
                            ],
                            rationale: 'Business designations like Inc., Ltd., Corp. retain periods.',
                            ref: '¬ß1.07'
                        }
                    ]
                },
                'academic-degrees': {
                    title: 'Academic Degrees',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'Which is the correct way to show someone with a Ph.D.?',
                            options: [
                                { label: 'Dr. John Smith, Ph.D.', correct: false },
                                { label: 'Dr. John Smith', correct: true },
                                { label: 'John Smith, PhD', correct: false },
                                { label: 'Dr John Smith Ph.D.', correct: false }
                            ],
                            rationale: 'Use either the title (Dr.) or degree (Ph.D.), not both.',
                            ref: '¬ß1.08'
                        }
                    ]
                }
            };
            
            // Initialize quizzes using FIXED API
            for (const section of sections) {
                const quiz = quizData[section.id];
                if (quiz) {
                    const container = document.getElementById(`quiz-${section.id}`);
                    if (container) {
                        // FIXED: Use correct constructor parameters
                        const engine = new QuizEngine(quiz, CHAPTER_ID, section.id);
                        const quizElement = engine.render();
                        container.appendChild(quizElement);
                    }
                }
            }
        }
        
        // Initialize navigation
        function initializeNavigation() {
            document.querySelectorAll('.tab-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const sectionId = link.dataset.section;
                    showSection(sectionId);
                    updateActiveTab(link);
                });
            });
        }
        
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Show target section
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.style.display = 'block';
            }
        }
        
        function updateActiveTab(activeLink) {
            document.querySelectorAll('.tab-link').forEach(link => {
                link.classList.remove('active');
            });
            activeLink.classList.add('active');
        }
        
        // Initialize everything
        document.addEventListener('DOMContentLoaded', () => {
            updateProgressBar();
            loadSectionQuizzes();
            initializeNavigation();
            
            if (!window.location.hash) {
                router.navigateTo(CHAPTER_ID, 'introduction');
            }
        });
        
        window.addEventListener('progress-changed', updateProgressBar);
    </script>
</body>
</html>
