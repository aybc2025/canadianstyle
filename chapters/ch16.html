<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 16: Revision & Proofreading - The Canadian Style</title>
    <link rel="stylesheet" href="../shared/css/main.css">
    <link rel="stylesheet" href="../shared/css/quiz-styles.css">
</head>
<body>
    <header class="site-header">
        <div class="container">
            <div class="logo-wrapper">
                <img src="../shared/img/maple-logo.svg" alt="Canadian Style Logo" class="logo">
                <h1>The Canadian Style</h1>
            </div>
            <nav class="chapter-nav">
                <a href="../index.html" class="btn btn-secondary">Back to Dashboard</a>
            </nav>
        </div>
    </header>

    <div class="chapter-hero">
        <div class="container">
            <nav class="breadcrumb">
                <a href="../index.html">Home</a> / Chapter 16
            </nav>
            <div class="chapter-meta">
                <div class="chapter-icon">16</div>
                <div>
                    <h1>Revision & Proofreading</h1>
                    <p>Polish your writing through systematic revision</p>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="chapterProgress" style="width: 0%"></div>
            </div>
        </div>
    </div>

    <nav class="section-tabs" id="sectionNav">
        <div class="container">
            <div class="tabs-list">
                <a href="#introduction" class="tab-link" data-section="introduction">16.01 Introduction</a>
                <a href="#editing-levels" class="tab-link" data-section="editing-levels">16.02 Levels of Editing</a>
                <a href="#structural-editing" class="tab-link" data-section="structural-editing">16.03 Structural Editing</a>
                <a href="#stylistic-editing" class="tab-link" data-section="stylistic-editing">16.04 Stylistic Editing</a>
                <a href="#copy-editing" class="tab-link" data-section="copy-editing">16.05 Copy Editing</a>
                <a href="#proofreading" class="tab-link" data-section="proofreading">16.06 Proofreading</a>
                <a href="#marks" class="tab-link" data-section="marks">16.07 Proofreader's Marks</a>
                <a href="#checklist" class="tab-link" data-section="checklist">16.08 Revision Checklist</a>
            </div>
        </div>
    </nav>

    <main class="chapter-content">
        <div class="container">
            <!-- Section 16.01: Introduction -->
            <section class="content-section" id="introduction">
                <div class="section-header">
                    <h2>16.01 Introduction</h2>
                </div>
                
                <div class="lesson-content">
                    <p>Effective revision and proofreading are essential final steps in the writing process. 
                    They ensure your documents are clear, correct, and professional.</p>
                    
                    <p>This chapter outlines the different levels of editing and provides systematic 
                    approaches to improving your writing.</p>
                    
                    <div class="editing-levels">
                        <div class="level-card">
                            <h4>Structural Editing</h4>
                            <p>Big-picture organization, logic, and content</p>
                        </div>
                        <div class="level-card">
                            <h4>Stylistic Editing</h4>
                            <p>Clarity, flow, and consistency of expression</p>
                        </div>
                        <div class="level-card">
                            <h4>Copy Editing</h4>
                            <p>Grammar, spelling, and mechanical correctness</p>
                        </div>
                        <div class="level-card">
                            <h4>Proofreading</h4>
                            <p>Final check for errors and formatting</p>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Panel -->
                <div class="quiz-panel" id="quiz-introduction"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('introduction')">
                        Complete Section ‚Üí Levels of Editing
                    </button>
                </div>
            </section>

            <!-- Section 16.02: Levels of Editing -->
            <section class="content-section" id="editing-levels">
                <div class="section-header">
                    <h2>16.02 Levels of Editing</h2>
                </div>
                
                <div class="lesson-content">
                    <h3>The Editing Hierarchy</h3>
                    <p>Editing proceeds from big picture to small details:</p>
                    
                    <div class="editing-sequence">
                        <div class="sequence-step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <h4>Structural Editing</h4>
                                <p>Organization, content development, logic, and flow</p>
                            </div>
                        </div>
                        <div class="sequence-step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <h4>Stylistic Editing</h4>
                                <p>Clarity, tone, word choice, and sentence structure</p>
                            </div>
                        </div>
                        <div class="sequence-step">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <h4>Copy Editing</h4>
                                <p>Grammar, spelling, punctuation, and consistency</p>
                            </div>
                        </div>
                        <div class="sequence-step">
                            <div class="step-number">4</div>
                            <div class="step-content">
                                <h4>Proofreading</h4>
                                <p>Final errors, formatting, and layout</p>
                            </div>
                        </div>
                    </div>

                    <h3>Why This Order Matters</h3>
                    <ul>
                        <li><strong>Efficiency:</strong> No point fixing grammar in paragraphs you might delete</li>
                        <li><strong>Effectiveness:</strong> Structure affects everything that follows</li>
                        <li><strong>Focus:</strong> Each level requires different mental approaches</li>
                        <li><strong>Quality:</strong> Systematic approach catches more issues</li>
                    </ul>

                    <h3>Multiple Passes</h3>
                    <p>Plan multiple editing passes, focusing on one level at a time:</p>
                    <ul>
                        <li>Allow time between passes for fresh perspective</li>
                        <li>Read for content before reading for mechanics</li>
                        <li>Consider having others review at different levels</li>
                        <li>Don't try to fix everything in one pass</li>
                    </ul>
                </div>
                
                <!-- Quiz Panel -->
                <div class="quiz-panel" id="quiz-editing-levels"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('editing-levels')">
                        Complete Section ‚Üí Structural Editing
                    </button>
                </div>
            </section>

            <!-- Section 16.03: Structural Editing -->
            <section class="content-section" id="structural-editing">
                <div class="section-header">
                    <h2>16.03 Structural Editing</h2>
                </div>
                
                <div class="lesson-content">
                    <h3>Focus Areas</h3>
                    <p>Structural editing addresses the foundation of your document:</p>
                    
                    <div class="examples-grid">
                        <div class="example-card">
                            <h4>üèóÔ∏è Organization</h4>
                            <ul>
                                <li>Logical sequence of ideas</li>
                                <li>Effective paragraph structure</li>
                                <li>Clear transitions between sections</li>
                                <li>Appropriate use of headings</li>
                            </ul>
                        </div>
                        <div class="example-card">
                            <h4>üìã Content</h4>
                            <ul>
                                <li>Completeness of information</li>
                                <li>Relevance to purpose and audience</li>
                                <li>Balance between sections</li>
                                <li>Accuracy of facts and data</li>
                            </ul>
                        </div>
                    </div>
                    
                    <h3>Questions to Ask</h3>
                    <ul>
                        <li>Does the introduction clearly state the purpose?</li>
                        <li>Is the information presented in logical order?</li>
                        <li>Are there gaps in the argument or explanation?</li>
                        <li>Does the conclusion effectively summarize key points?</li>
                        <li>Will the audience understand the document's message?</li>
                    </ul>
                    
                    <div class="revision-tips">
                        <h3>üí° Structural Editing Tips</h3>
                        <ul>
                            <li>Read the entire document before making changes</li>
                            <li>Create an outline of the existing structure</li>
                            <li>Consider major reorganization if needed</li>
                            <li>Don't worry about minor errors at this stage</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Quiz Panel -->
                <div class="quiz-panel" id="quiz-structural-editing"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('structural-editing')">
                        Complete Section ‚Üí Stylistic Editing
                    </button>
                </div>
            </section>

            <!-- Section 16.04: Stylistic Editing -->
            <section class="content-section" id="stylistic-editing">
                <div class="section-header">
                    <h2>16.04 Stylistic Editing</h2>
                </div>
                
                <div class="lesson-content">
                    <h3>Improving Clarity and Flow</h3>
                    <p>Stylistic editing focuses on how ideas are expressed:</p>
                    
                    <div class="examples-grid">
                        <div class="example-card avoid">
                            <h4>‚ùå Before Stylistic Editing</h4>
                            <p>"It is important to note that the implementation of the new system will result in 
                            the enhancement of our operational efficiency and the improvement of customer satisfaction 
                            levels across all service delivery channels."</p>
                        </div>
                        <div class="example-card prefer">
                            <h4>‚úÖ After Stylistic Editing</h4>
                            <p>"The new system will improve our efficiency and customer satisfaction."</p>
                        </div>
                    </div>

                    <h3>Key Areas</h3>
                    <div class="revision-areas">
                        <div class="area-card">
                            <h4>Clarity</h4>
                            <ul>
                                <li>Eliminate jargon and buzzwords</li>
                                <li>Use concrete, specific language</li>
                                <li>Break up complex sentences</li>
                                <li>Define technical terms</li>
                            </ul>
                        </div>
                        <div class="area-card">
                            <h4>Conciseness</h4>
                            <ul>
                                <li>Remove redundant phrases</li>
                                <li>Cut unnecessary words</li>
                                <li>Combine related sentences</li>
                                <li>Use active voice when appropriate</li>
                            </ul>
                        </div>
                        <div class="area-card">
                            <h4>Flow</h4>
                            <ul>
                                <li>Improve transitions between ideas</li>
                                <li>Vary sentence length and structure</li>
                                <li>Ensure paragraph unity</li>
                                <li>Create smooth connections</li>
                            </ul>
                        </div>
                    </div>

                    <h3>Common Improvements</h3>
                    <div class="replacement-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Wordy</th>
                                    <th>Concise</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>in order to</td>
                                    <td>to</td>
                                </tr>
                                <tr>
                                    <td>due to the fact that</td>
                                    <td>because</td>
                                </tr>
                                <tr>
                                    <td>at this point in time</td>
                                    <td>now</td>
                                </tr>
                                <tr>
                                    <td>in the event that</td>
                                    <td>if</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Quiz Panel -->
                <div class="quiz-panel" id="quiz-stylistic-editing"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('stylistic-editing')">
                        Complete Section ‚Üí Copy Editing
                    </button>
                </div>
            </section>

            <!-- Section 16.05: Copy Editing -->
            <section class="content-section" id="copy-editing">
                <div class="section-header">
                    <h2>16.05 Copy Editing</h2>
                </div>
                
                <div class="lesson-content">
                    <h3>Mechanical Correctness</h3>
                    <p>Copy editing ensures technical accuracy:</p>
                    
                    <div class="checklist-section">
                        <h3>Copy Editing Checklist</h3>
                        <div class="editing-levels">
                            <div class="level-card">
                                <h4>Grammar</h4>
                                <ul>
                                    <li>Subject-verb agreement</li>
                                    <li>Pronoun reference and agreement</li>
                                    <li>Correct tense usage</li>
                                    <li>Proper sentence structure</li>
                                </ul>
                            </div>
                            <div class="level-card">
                                <h4>Punctuation</h4>
                                <ul>
                                    <li>Commas, semicolons, colons</li>
                                    <li>Apostrophes and quotation marks</li>
                                    <li>Hyphens and dashes</li>
                                    <li>Periods and other end marks</li>
                                </ul>
                            </div>
                            <div class="level-card">
                                <h4>Spelling & Usage</h4>
                                <ul>
                                    <li>Correct spelling throughout</li>
                                    <li>Proper word usage</li>
                                    <li>Consistent Canadian spelling</li>
                                    <li>Commonly confused words</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <h3>Style Consistency</h3>
                    <ul>
                        <li>Numbers and dates</li>
                        <li>Capitalization</li>
                        <li>Abbreviations and acronyms</li>
                        <li>Citations and references</li>
                        <li>Headings and subheadings</li>
                    </ul>

                    <h3>Tools and Techniques</h3>
                    <ul>
                        <li>Use spell-check, but don't rely on it exclusively</li>
                        <li>Read carefully for homophones (there/their/they're)</li>
                        <li>Check consistency of style choices</li>
                        <li>Verify facts, figures, and references</li>
                        <li>Use style guides for consistency</li>
                    </ul>
                </div>
                
                <!-- Quiz Panel -->
                <div class="quiz-panel" id="quiz-copy-editing"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('copy-editing')">
                        Complete Section ‚Üí Proofreading
                    </button>
                </div>
            </section>

            <!-- Section 16.06: Proofreading -->
            <section class="content-section" id="proofreading">
                <div class="section-header">
                    <h2>16.06 Proofreading</h2>
                </div>
                
                <div class="lesson-content">
                    <h3>Final Quality Check</h3>
                    <p>Proofreading is the final step before publication:</p>
                    
                    <div class="proofreading-levels">
                        <div class="level-card">
                            <h4>Content</h4>
                            <ul>
                                <li>Final typos and errors</li>
                                <li>Missing words or sentences</li>
                                <li>Repeated words or phrases</li>
                                <li>Incorrect names and titles</li>
                            </ul>
                        </div>
                        <div class="level-card">
                            <h4>Format</h4>
                            <ul>
                                <li>Consistent fonts and spacing</li>
                                <li>Proper margins and alignment</li>
                                <li>Tables and figures</li>
                                <li>Headers and footers</li>
                            </ul>
                        </div>
                        <div class="level-card">
                            <h4>Details</h4>
                            <ul>
                                <li>Page numbers</li>
                                <li>Cross-references</li>
                                <li>Table of contents</li>
                                <li>Final typos</li>
                            </ul>
                        </div>
                    </div>

                    <h3>Proofreading Techniques</h3>
                    <ul>
                        <li><strong>Read backwards:</strong> Start from the end to catch spelling errors</li>
                        <li><strong>Read aloud:</strong> Helps catch missing words and awkward phrasing</li>
                        <li><strong>Use a ruler:</strong> Focus on one line at a time</li>
                        <li><strong>Print it out:</strong> Different format reveals different errors</li>
                        <li><strong>Take breaks:</strong> Fresh eyes catch more errors</li>
                    </ul>

                    <h3>What to Look For</h3>
                    <ul>
                        <li>Spelling errors that spell-check missed</li>
                        <li>Formatting inconsistencies</li>
                        <li>Incorrect punctuation</li>
                        <li>Missing or repeated words</li>
                        <li>Layout and design issues</li>
                    </ul>
                </div>
                
                <!-- Quiz Panel -->
                <div class="quiz-panel" id="quiz-proofreading"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('proofreading')">
                        Complete Section ‚Üí Proofreader's Marks
                    </button>
                </div>
            </section>

            <!-- Section 16.07: Proofreader's Marks -->
            <section class="content-section" id="marks">
                <div class="section-header">
                    <h2>16.07 Proofreader's Marks</h2>
                </div>
                
                <div class="lesson-content">
                    <h3>Standard Correction Symbols</h3>
                    <p>Use these traditional marks for clear, efficient proofreading:</p>
                    
                    <div class="marks-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Mark</th>
                                    <th>Name</th>
                                    <th>Meaning</th>
                                    <th>Example</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>^</td>
                                    <td>caret</td>
                                    <td>Insert</td>
                                    <td>The b^o^ok is here</td>
                                </tr>
                                <tr>
                                    <td>‚åê</td>
                                    <td>dele</td>
                                    <td>Delete</td>
                                    <td>The‚åên book is here</td>
                                </tr>
                                <tr>
                                    <td>‚åò</td>
                                    <td>close up</td>
                                    <td>Remove space</td>
                                    <td>base‚åòball</td>
                                </tr>
                                <tr>
                                    <td>#</td>
                                    <td>space</td>
                                    <td>Insert space</td>
                                    <td>the#book</td>
                                </tr>
                                <tr>
                                    <td>tr</td>
                                    <td>transpose</td>
                                    <td>Switch order</td>
                                    <td>th‚åêtr^e book</td>
                                </tr>
                                <tr>
                                    <td>stet</td>
                                    <td>let stand</td>
                                    <td>Ignore correction</td>
                                    <td>stet (dots under)</td>
                                </tr>
                                <tr>
                                    <td>¬∂</td>
                                    <td>paragraph</td>
                                    <td>New paragraph</td>
                                    <td>text.¬∂New paragraph</td>
                                </tr>
                                <tr>
                                    <td>‚åê¬∂</td>
                                    <td>no paragraph</td>
                                    <td>Run in</td>
                                    <td>Run‚åê¬∂in with previous</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>Capitalization Marks</h3>
                    <div class="examples-grid">
                        <div class="example-card">
                            <h4>Uppercase</h4>
                            <p>Three lines under letter: <u>c</u>anada ‚Üí Canada</p>
                        </div>
                        <div class="example-card">
                            <h4>Lowercase</h4>
                            <p>Slash through letter: The /B/ook ‚Üí The book</p>
                        </div>
                    </div>

                    <h3>Using Proofreader's Marks</h3>
                    <ul>
                        <li>Make marks in margins for visibility</li>
                        <li>Use standard symbols consistently</li>
                        <li>Write clearly and legibly</li>
                        <li>Number pages if marks continue</li>
                        <li>Include explanation for unusual marks</li>
                    </ul>
                </div>
                
                <!-- Quiz Panel -->
                <div class="quiz-panel" id="quiz-marks"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('marks')">
                        Complete Section ‚Üí Revision Checklist
                    </button>
                </div>
            </section>

            <!-- Section 16.08: Revision Checklist -->
            <section class="content-section" id="checklist">
                <div class="section-header">
                    <h2>16.08 Revision Checklist</h2>
                </div>
                
                <div class="lesson-content">
                    <h3>Comprehensive Review</h3>
                    <p>Use this checklist to ensure thorough revision:</p>
                    
                    <div class="revision-checklist">
                        <h3>Structural Level</h3>
                        <ul>
                            <li>‚ñ° Purpose and audience are clear</li>
                            <li>‚ñ° Information is complete and accurate</li>
                            <li>‚ñ° Ideas are logically organized</li>
                            <li>‚ñ° Each paragraph has a clear focus</li>
                            <li>‚ñ° Transitions connect ideas smoothly</li>
                            <li>‚ñ° Document meets audience needs</li>
                        </ul>
                        
                        <h3>Stylistic Level</h3>
                        <ul>
                            <li>‚ñ° Tone is appropriate and consistent</li>
                            <li>‚ñ° Voice is clear and engaging</li>
                            <li>‚ñ° Sentences vary in length and structure</li>
                            <li>‚ñ° Transitions connect ideas smoothly</li>
                            <li>‚ñ° Wordiness has been eliminated</li>
                            <li>‚ñ° Jargon is appropriate for audience</li>
                            <li>‚ñ° Active voice is used when appropriate</li>
                            <li>‚ñ° Parallel structure is maintained</li>
                        </ul>
                        
                        <h3>Copy Editing Level</h3>
                        <ul>
                            <li>‚ñ° Grammar is correct throughout</li>
                            <li>‚ñ° Spelling is accurate (not just spell-checked)</li>
                            <li>‚ñ° Punctuation follows standard rules</li>
                            <li>‚ñ° Capitalization is consistent</li>
                            <li>‚ñ° Numbers follow style guide</li>
                            <li>‚ñ° Abbreviations are used correctly</li>
                            <li>‚ñ° Citations and references are complete</li>
                            <li>‚ñ° Style guide has been followed</li>
                        </ul>
                        
                        <h3>Proofreading Level</h3>
                        <ul>
                            <li>‚ñ° Typography is consistent</li>
                            <li>‚ñ° Formatting follows guidelines</li>
                            <li>‚ñ° Page numbers are correct</li>
                            <li>‚ñ° Headers and footers are accurate</li>
                            <li>‚ñ° Cross-references are correct</li>
                            <li>‚ñ° Table of contents matches headings</li>
                            <li>‚ñ° Images and captions are properly placed</li>
                            <li>‚ñ° Final typos have been caught</li>
                        </ul>
                    </div>
                    
                    <div class="revision-tips">
                        <h3>üéØ Final Tips</h3>
                        <p>Remember that good writing is rewriting. Don't expect to catch everything in one pass. 
                        Take breaks between revision sessions, and when possible, have someone else review your work 
                        with fresh eyes.</p>
                    </div>
                </div>
                
                <!-- Quiz Panel -->
                <div class="quiz-panel" id="quiz-checklist"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('checklist')">
                        Complete Chapter
                    </button>
                </div>
            </section>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; 2024 Government of Canada. Based on <em>The Canadian Style</em> (1997 revised edition)</p>
        </div>
    </footer>

    <script type="module">
        import { router } from '../shared/js/router.js';
        import { getProgress, setProgress } from '../shared/js/progress.js';
        import { QuizEngine } from '../shared/js/quiz-engine.js';
        import '../shared/js/components.js';
        
        const CHAPTER_ID = 'ch16';
        const sections = [
            { id: 'introduction', title: '16.01 Introduction' },
            { id: 'editing-levels', title: '16.02 Levels of Editing' },
            { id: 'structural-editing', title: '16.03 Structural Editing' },
            { id: 'stylistic-editing', title: '16.04 Stylistic Editing' },
            { id: 'copy-editing', title: '16.05 Copy Editing' },
            { id: 'proofreading', title: '16.06 Proofreading' },
            { id: 'marks', title: '16.07 Proofreader\'s Marks' },
            { id: 'checklist', title: '16.08 Revision Checklist' }
        ];
        
        // Initialize progress bar
        function updateProgressBar() {
            const progress = getProgress(CHAPTER_ID);
            const chapterProgress = progress || {};
            const completed = Object.values(chapterProgress).filter(Boolean).length;
            const percentage = Math.round((completed / sections.length) * 100);
            
            document.getElementById('chapterProgress').style.width = percentage + '%';
        }
        
        // Mark section as complete
        window.completeSection = function(sectionId) {
            setProgress(CHAPTER_ID, sectionId, true);
            updateProgressBar();
            
            // Navigate to next section
            const currentIndex = sections.findIndex(s => s.id === sectionId);
            if (currentIndex < sections.length - 1) {
                const nextSection = sections[currentIndex + 1];
                showSection(nextSection.id);
                updateActiveTab(document.querySelector(`[data-section="${nextSection.id}"]`));
            } else {
                // Chapter complete
                showCompletionModal();
            }
        };
        
        function showCompletionModal() {
            const modal = document.createElement('div');
            modal.className = 'completion-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <h3>üéâ Chapter 16 Complete!</h3>
                    <p>Congratulations! You've completed The Canadian Style course. 
                    You now have the tools to write clear, correct, and professional documents.</p>
                    <div class="modal-actions">
                        <button class="btn btn-outline" onclick="this.closest('.completion-modal').remove()">
                            Stay Here
                        </button>
                        <a href="../index.html" class="btn btn-primary">
                            Back to Dashboard
                        </a>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        // Section navigation
        function initSectionNavigation() {
            const tabs = document.querySelectorAll('.tab-link');
            tabs.forEach(tab => {
                tab.addEventListener('click', (e) => {
                    e.preventDefault();
                    const sectionId = tab.getAttribute('data-section');
                    
                    // Update active tab
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    // Show/hide sections
                    const sections = document.querySelectorAll('.content-section');
                    sections.forEach(section => {
                        section.classList.remove('active');
                    });
                    document.getElementById(sectionId).classList.add('active');
                    
                    // Update URL hash
                    window.location.hash = sectionId;
                });
            });
            
            // Handle initial hash
            const hash = window.location.hash.replace('#', '');
            if (hash && document.getElementById(hash)) {
                const tab = document.querySelector(`[data-section="${hash}"]`);
                if (tab) tab.click();
            } else {
                // Default to first section
                tabs[0]?.click();
            }
        }
        
        // Load section quizzes from JSON files
        async function loadSectionQuizzes() {
            try {
                const response = await fetch(`../data/ch16-quiz.json`);
                if (!response.ok) {
                    console.warn('Quiz data not available for chapter 16');
                    return;
                }
                
                const quizData = await response.json();
                
                // Initialize quizzes for sections that have them
                sections.forEach(section => {
                    const sectionQuizData = quizData.sections?.[section.id];
                    if (sectionQuizData && sectionQuizData.questions) {
                        const quizContainer = document.getElementById(`quiz-${section.id}`);
                        if (quizContainer) {
                            const quizEngine = new QuizEngine(sectionQuizData, CHAPTER_ID, section.id);
                            quizEngine.render(quizContainer);
                        }
                    }
                });
            } catch (error) {
                console.warn('Error loading quiz data:', error);
            }
        }
        
        // Initialize page
        initSectionNavigation();
        updateProgressBar();
        loadSectionQuizzes();
        
        // Handle window beforeunload for quiz warnings
        window.addEventListener('beforeunload', (event) => {
            const activeQuiz = document.querySelector('.quiz-engine-container .quiz-in-progress');
            if (activeQuiz) {
                event.preventDefault();
                event.returnValue = 'You have a quiz in progress. Are you sure you want to leave?';
            }
        });
        
        window.addEventListener('progress-changed', updateProgressBar);
    </script>
</body>
</html>
