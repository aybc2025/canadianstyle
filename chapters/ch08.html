<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 8: Quotations & Quotation Marks - The Canadian Style</title>
    <link rel="stylesheet" href="../shared/css/main.css">
    <link rel="stylesheet" href="../shared/css/quiz-styles.css">
</head>
<body>
    <div class="chapter-container">
        <header class="chapter-header">
            <div class="breadcrumb">
                <a href="../index.html" class="breadcrumb-link">‚Üê Dashboard</a>
                <span class="breadcrumb-separator">/</span>
                <span class="breadcrumb-current">Chapter 8: Quotations & Quotation Marks</span>
            </div>
            <div class="chapter-progress">
                <div class="progress-bar">
                    <div class="progress-fill" id="chapterProgress"></div>
                </div>
                <span class="progress-text">Progress</span>
            </div>
        </header>

        <nav class="chapter-nav">
            <div class="nav-links">
                <a href="#introduction" class="tab-link active" data-section="introduction">8.01 Introduction</a>
                <a href="#quotation-marks" class="tab-link" data-section="quotation-marks">8.02 Quotation Marks</a>
                <a href="#dialogue" class="tab-link" data-section="dialogue">8.15 Dialogue</a>
                <a href="#citations" class="tab-link" data-section="citations">8.20 Citations</a>
                <a href="#block-quotes" class="tab-link" data-section="block-quotes">8.25 Block Quotes</a>
                <a href="#punctuation" class="tab-link" data-section="punctuation">8.30 Punctuation</a>
            </div>
        </nav>

        <main class="chapter-content">
            <!-- Introduction Section -->
            <section class="content-section" id="introduction">
                <div class="section-header">
                    <h2>8.01 Introduction to Quotations</h2>
                </div>
                
                <div class="content-block">
                    <p>Quotation marks indicate direct speech, titles of shorter works, and words used in special ways. Canadian style follows specific conventions for accuracy and consistency in quoting sources.</p>
                    
                    <div class="key-principles">
                        <h3>Basic Principles</h3>
                        <ul>
                            <li>Quote sources exactly and accurately</li>
                            <li>Use quotation marks consistently</li>
                            <li>Integrate quotes smoothly into text</li>
                            <li>Provide proper attribution</li>
                        </ul>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Types of Quotations</h4>
                            <ul>
                                <li><strong>Direct speech:</strong> "I agree," she said</li>
                                <li><strong>Titles:</strong> "Chapter 1: Overview"</li>
                                <li><strong>Special terms:</strong> "user-friendly" interface</li>
                                <li><strong>Definitions:</strong> "Efficiency" means optimal use</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Canadian Style Features</h4>
                            <ul>
                                <li>Double quotation marks for main quotes</li>
                                <li>Single quotes within double quotes</li>
                                <li>Logical punctuation placement</li>
                                <li>Consistent capitalization rules</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Panel for Introduction -->
                <div class="quiz-panel" id="quiz-introduction"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('introduction')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Quotation Marks Section -->
            <section class="content-section" id="quotation-marks" style="display: none;">
                <div class="section-header">
                    <h2>8.02 Quotation Marks</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Double vs. Single Quotation Marks</h4>
                        <p>Use double quotation marks for main quotations and single marks for quotes within quotes.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Double Quotation Marks</h4>
                            <ul>
                                <li>"We need to act quickly," the minister said</li>
                                <li>The report is titled "Economic Outlook 2025"</li>
                                <li>The term "stakeholder" appears frequently</li>
                                <li>"Please submit your application by Friday"</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Single Quotation Marks</h4>
                            <ul>
                                <li>She said, "The memo states 'urgent action required'"</li>
                                <li>"Read chapter 'Getting Started' first"</li>
                                <li>"The term 'user-friendly' is overused"</li>
                                <li>"We discussed 'Plan B' at the meeting"</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Titles and Special Terms</h4>
                        <ul>
                            <li><strong>Article titles:</strong> "The Future of Remote Work"</li>
                            <li><strong>Chapter titles:</strong> "Introduction to Management"</li>
                            <li><strong>Song titles:</strong> "O Canada"</li>
                            <li><strong>Special meaning:</strong> The so-called "experts"</li>
                        </ul>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Technical Terms</h4>
                            <ul>
                                <li>Click the "Submit" button</li>
                                <li>Select "File" then "Print"</li>
                                <li>The "Settings" menu appears</li>
                                <li>Type "Y" for yes or "N" for no</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Irony and Special Usage</h4>
                            <ul>
                                <li>Their "efficient" system took hours</li>
                                <li>The "quick" meeting lasted three hours</li>
                                <li>His "helpful" suggestion created problems</li>
                                <li>The "simple" process has 20 steps</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Panel for Quotation Marks -->
                <div class="quiz-panel" id="quiz-quotation-marks"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('quotation-marks')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Dialogue Section -->
            <section class="content-section" id="dialogue" style="display: none;">
                <div class="section-header">
                    <h2>8.15 Writing Dialogue</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Dialogue Formatting</h4>
                        <p>Start a new paragraph each time the speaker changes, and use proper punctuation with speech tags.</p>
                    </div>
                    
                    <div class="dialogue-example">
                        <h4>Correct Dialogue Format:</h4>
                        <div class="dialogue-text">
                            <p>"Good morning, Minister," the deputy said as she entered the office.</p>
                            <p>"Good morning, Sarah. What's on the agenda today?"</p>
                            <p>"We have three meetings scheduled," she replied, consulting her notes. "The budget review is first."</p>
                            <p>"Excellent. Are the documents ready?"</p>
                            <p>"Yes, they're on your desk."</p>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Punctuation with Speech Tags</h4>
                        <ul>
                            <li><strong>Tag after:</strong> "Hello," she said.</li>
                            <li><strong>Tag before:</strong> She said, "Hello."</li>
                            <li><strong>Tag in middle:</strong> "Hello," she said, "how are you?"</li>
                            <li><strong>No tag:</strong> "Hello." (period inside)</li>
                        </ul>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Questions and Exclamations</h4>
                            <ul>
                                <li>"Are you ready?" she asked.</li>
                                <li>"Absolutely!" he replied.</li>
                                <li>"When," she asked, "will you finish?"</li>
                                <li>"Never!" was his emphatic response.</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Interrupted Speech</h4>
                            <ul>
                                <li>"I think we should‚Äî" "No, wait."</li>
                                <li>"The meeting is‚Äî" She paused.</li>
                                <li>"We need to..." He trailed off.</li>
                                <li>"But‚Äî" "Let me finish."</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Speech Tag Alternatives</h4>
                        <p>Vary speech tags for better writing:</p>
                        <ul>
                            <li><strong>Basic:</strong> said, asked, replied</li>
                            <li><strong>Emotion:</strong> whispered, shouted, muttered</li>
                            <li><strong>Manner:</strong> explained, announced, suggested</li>
                            <li><strong>Action beats:</strong> She smiled. "That's perfect."</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Quiz Panel for Dialogue -->
                <div class="quiz-panel" id="quiz-dialogue"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('dialogue')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Citations Section -->
            <section class="content-section" id="citations" style="display: none;">
                <div class="section-header">
                    <h2>8.20 Citations and Attribution</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Integrating Quotations</h4>
                        <p>Introduce quotations smoothly and provide clear attribution to sources.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Introducing Quotes</h4>
                            <ul>
                                <li>According to the minister, "Budget priorities will shift"</li>
                                <li>The report states that "revenue increased by 15%"</li>
                                <li>As Smith argues, "Policy reform is essential"</li>
                                <li>The data shows that "unemployment fell sharply"</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Attribution Placement</h4>
                            <ul>
                                <li>"We must act now," the minister said</li>
                                <li>The minister said, "We must act now"</li>
                                <li>"We must," the minister said, "act now"</li>
                                <li>"We must act now" (Minister's Office, 2024)</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Partial Quotations</h4>
                        <p>Integrate quoted phrases naturally into your sentences:</p>
                        <ul>
                            <li>The minister called the results "very encouraging"</li>
                            <li>Officials described the plan as "ambitious but achievable"</li>
                            <li>The report warns of "significant challenges ahead"</li>
                        </ul>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Alterations to Quotes</h4>
                            <ul>
                                <li><strong>Additions:</strong> "We [the government] will proceed"</li>
                                <li><strong>Omissions:</strong> "The plan... will succeed"</li>
                                <li><strong>Changes:</strong> "[T]he plan will succeed" (capitalization)</li>
                                <li><strong>Errors:</strong> "The plan [sic] will succeed"</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Paraphrasing vs. Quoting</h4>
                            <ul>
                                <li><strong>Quote:</strong> The minister said, "We will increase funding"</li>
                                <li><strong>Paraphrase:</strong> The minister promised increased funding</li>
                                <li><strong>Mixed:</strong> The minister promised "significant" funding increases</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Panel for Citations -->
                <div class="quiz-panel" id="quiz-citations"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('citations')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Block Quotes Section -->
            <section class="content-section" id="block-quotes" style="display: none;">
                <div class="section-header">
                    <h2>8.25 Block Quotations</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>When to Use Block Quotes</h4>
                        <p>Use block quotations for longer quotes (typically 40+ words) that deserve special emphasis.</p>
                    </div>
                    
                    <div class="block-quote-example">
                        <h4>Block Quote Format:</h4>
                        <p>The Prime Minister outlined the government's approach:</p>
                        <blockquote>
                            Our strategy is built on three pillars: economic growth through innovation, environmental sustainability through responsible development, and social progress through inclusive policies. These principles will guide all our decisions and ensure that Canada remains competitive while maintaining our values and protecting our environment for future generations.
                        </blockquote>
                        <p>This comprehensive approach addresses multiple challenges simultaneously.</p>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Block Quote Guidelines</h4>
                        <ul>
                            <li>Indent the entire quote (usually 1/2 inch or 1.3 cm)</li>
                            <li>Do not use quotation marks around the block</li>
                            <li>Maintain double spacing if document is double-spaced</li>
                            <li>Include citation after the closing punctuation</li>
                        </ul>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>With Citation</h4>
                            <div class="block-quote-example">
                                <p>The report concludes:</p>
                                <blockquote>
                                    The evidence clearly demonstrates that early intervention programs produce measurable improvements in educational outcomes, with participants showing 25% better performance on standardized tests and 40% higher graduation rates compared to control groups.
                                </blockquote>
                                <p class="citation">(Educational Research Institute, 2024, p. 156)</p>
                            </div>
                        </div>
                        
                        <div class="example-item">
                            <h4>Multiple Paragraphs</h4>
                            <div class="block-quote-example">
                                <p>The policy document states:</p>
                                <blockquote>
                                    <p>Climate action requires immediate and sustained effort across all sectors of society. Government cannot solve this challenge alone.</p>
                                    <p>We need partnerships with business, civil society, and individual Canadians to achieve our ambitious targets for 2030 and beyond.</p>
                                </blockquote>
                            </div>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Poetry and Verse</h4>
                        <p>For poetry, maintain original line breaks and spacing:</p>
                        <blockquote style="text-align: left;">
                            O Canada!<br>
                            Our home and native land!<br>
                            True patriot love in all thy sons command.
                        </blockquote>
                    </div>
                </div>
                
                <!-- Quiz Panel for Block Quotes -->
                <div class="quiz-panel" id="quiz-block-quotes"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('block-quotes')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Punctuation Section -->
            <section class="content-section" id="punctuation" style="display: none;">
                <div class="section-header">
                    <h2>8.30 Punctuation with Quotation Marks</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Canadian Punctuation Style</h4>
                        <p>Canadian style uses logical punctuation: periods and commas go inside quotation marks only when they're part of the quoted material.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Periods and Commas</h4>
                            <ul>
                                <li><strong>Part of quote:</strong> She said, "I agree."</li>
                                <li><strong>Not part of quote:</strong> She called it "urgent".</li>
                                <li><strong>List item:</strong> The options are "yes", "no", and "maybe".</li>
                                <li><strong>Before tag:</strong> "I agree," she said.</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Questions and Exclamations</h4>
                            <ul>
                                <li><strong>Quote is question:</strong> She asked, "Are you ready?"</li>
                                <li><strong>Sentence is question:</strong> Did she say "ready"?</li>
                                <li><strong>Both questions:</strong> Did she ask, "Are you ready?"</li>
                                <li><strong>Exclamation:</strong> He shouted, "Stop!"</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Semicolons and Colons</h4>
                        <p>Semicolons and colons always go outside quotation marks:</p>
                        <ul>
                            <li>She said "yes"; however, she had concerns</li>
                            <li>Three people said "no": Smith, Jones, and Brown</li>
                            <li>The report mentions "urgent action"; we must respond</li>
                        </ul>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Complex Examples</h4>
                            <ul>
                                <li>"Are you," she asked, "coming to the meeting?"</li>
                                <li>He said, "I'll be there at 9:00."</li>
                                <li>The memo states "high priority"; we should respond quickly</li>
                                <li>She called it "essential"; I called it "optional".</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>American vs. Canadian Style</h4>
                            <ul>
                                <li><strong>American:</strong> She said "yes."</li>
                                <li><strong>Canadian:</strong> She said "yes".</li>
                                <li><strong>American:</strong> The "best" option.</li>
                                <li><strong>Canadian:</strong> The "best" option.</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Special Cases</h4>
                        <ul>
                            <li><strong>Titles with punctuation:</strong> "Who's Afraid of Virginia Woolf?"</li>
                            <li><strong>Technical terms:</strong> Click "File", then "Save".</li>
                            <li><strong>Multiple quotes:</strong> "Yes", "no", and "maybe" are the options</li>
                            <li><strong>Ellipsis:</strong> "We should..." she began</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Quiz Panel for Punctuation -->
                <div class="quiz-panel" id="quiz-punctuation"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('punctuation')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Include JavaScript modules -->
    <script type="module" src="../shared/js/router.js"></script>
    <script type="module" src="../shared/js/quiz-engine.js"></script>
    <script type="module" src="../shared/js/progress.js"></script>
    <script type="module" src="../shared/js/components.js"></script>

    <script type="module">
        import { router } from '../shared/js/router.js';
        import { getChapterProgress, setProgress } from '../shared/js/progress.js';
        import { QuizEngine } from '../shared/js/quiz-engine.js';
        
        const CHAPTER_ID = 'ch08';
        const sections = [
            { id: 'introduction', title: '8.01 Introduction' },
            { id: 'quotation-marks', title: '8.02 Quotation Marks' },
            { id: 'dialogue', title: '8.15 Dialogue' },
            { id: 'citations', title: '8.20 Citations' },
            { id: 'block-quotes', title: '8.25 Block Quotes' },
            { id: 'punctuation', title: '8.30 Punctuation' }
        ];
        
        // Initialize router
        router.init(CHAPTER_ID, sections);
        
        // Update progress bar using correct API
        function updateProgressBar() {
            const chapterProgress = getChapterProgress(CHAPTER_ID);
            const completed = Object.values(chapterProgress).filter(Boolean).length;
            const percentage = Math.round((completed / sections.length) * 100);
            
            const progressBar = document.getElementById('chapterProgress');
            if (progressBar) {
                progressBar.style.width = percentage + '%';
            }
        }
        
        // Mark section as complete
        window.completeSection = function(sectionId) {
            setProgress(CHAPTER_ID, sectionId, true);
            updateProgressBar();
            
            // Navigate to next section
            const currentIndex = sections.findIndex(s => s.id === sectionId);
            if (currentIndex < sections.length - 1) {
                const nextSection = sections[currentIndex + 1];
                router.navigateTo(CHAPTER_ID, nextSection.id);
            } else {
                // Chapter complete
                showCompletionModal();
            }
        };
        
        function showCompletionModal() {
            const modal = document.createElement('div');
            modal.className = 'completion-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <h3>üéâ Chapter 8 Complete!</h3>
                    <p>You've mastered quotations and quotation marks. Ready for the next chapter?</p>
                    <div class="modal-actions">
                        <button class="btn btn-outline" onclick="this.closest('.completion-modal').remove()">
                            Stay Here
                        </button>
                        <a href="../index.html" class="btn btn-primary">
                            Back to Dashboard
                        </a>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        // Load section quizzes - FIXED VERSION
        async function loadSectionQuizzes() {
            // Sample quiz data - in real implementation, this would come from JSON files
            const quizData = {
                introduction: {
                    title: 'Introduction to Quotations',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'What is the primary purpose of quotation marks?',
                            options: [
                                { label: 'To make text look professional', correct: false },
                                { label: 'To indicate direct speech and special terms', correct: true },
                                { label: 'To emphasize important words', correct: false },
                                { label: 'To replace italics', correct: false }
                            ],
                            rationale: 'Quotation marks primarily indicate direct speech, titles, and special terms.',
                            ref: '¬ß8.01'
                        }
                    ]
                },
                'quotation-marks': {
                    title: 'Quotation Marks',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'Which uses quotation marks correctly?',
                            options: [
                                { label: 'She said, "The memo states \'urgent action required\'"', correct: true },
                                { label: 'She said, \'The memo states "urgent action required"\'', correct: false },
                                { label: 'She said, "The memo states "urgent action required""', correct: false },
                                { label: 'She said, (The memo states "urgent action required")', correct: false }
                            ],
                            rationale: 'Use double quotes for main quotations and single quotes within doubles.',
                            ref: '¬ß8.02'
                        }
                    ]
                },
                dialogue: {
                    title: 'Writing Dialogue',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'What should you do when a new person speaks?',
                            options: [
                                { label: 'Continue in the same paragraph', correct: false },
                                { label: 'Start a new paragraph', correct: true },
                                { label: 'Use a semicolon', correct: false },
                                { label: 'Add extra quotation marks', correct: false }
                            ],
                            rationale: 'Always start a new paragraph when a different person speaks.',
                            ref: '¬ß8.15'
                        }
                    ]
                },
                citations: {
                    title: 'Citations',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'How should you indicate an addition to a quote?',
                            options: [
                                { label: 'Use parentheses (addition)', correct: false },
                                { label: 'Use square brackets [addition]', correct: true },
                                { label: 'Use italics addition', correct: false },
                                { label: 'Use asterisks *addition*', correct: false }
                            ],
                            rationale: 'Use square brackets to indicate additions or changes to quoted material.',
                            ref: '¬ß8.20'
                        }
                    ]
                },
                'block-quotes': {
                    title: 'Block Quotes',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'When should you use a block quotation?',
                            options: [
                                { label: 'For any important quote', correct: false },
                                { label: 'For quotes of 40+ words', correct: true },
                                { label: 'For quotes from officials', correct: false },
                                { label: 'For quotes in lists', correct: false }
                            ],
                            rationale: 'Block quotes are typically used for longer quotations (40+ words).',
                            ref: '¬ß8.25'
                        }
                    ]
                },
                punctuation: {
                    title: 'Punctuation with Quotes',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'In Canadian style, where does the period go: She called it "urgent"',
                            options: [
                                { label: 'She called it "urgent."', correct: false },
                                { label: 'She called it "urgent".', correct: true },
                                { label: 'She called it "urgent,"', correct: false },
                                { label: 'She called it "urgent";', correct: false }
                            ],
                            rationale: 'Canadian style uses logical punctuation - periods go outside when not part of the quote.',
                            ref: '¬ß8.30'
                        }
                    ]
                }
            };
            
            // Initialize quizzes using FIXED API
            for (const section of sections) {
                const quiz = quizData[section.id];
                if (quiz) {
                    const container = document.getElementById(`quiz-${section.id}`);
                    if (container) {
                        // FIXED: Use correct constructor parameters
                        const engine = new QuizEngine(quiz, CHAPTER_ID, section.id);
                        const quizElement = engine.render();
                        container.appendChild(quizElement);
                    }
                }
            }
        }
        
        // Initialize navigation
        function initializeNavigation() {
            document.querySelectorAll('.tab-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const sectionId = link.dataset.section;
                    showSection(sectionId);
                    updateActiveTab(link);
                });
            });
        }
        
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Show target section
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.style.display = 'block';
            }
        }
        
        function updateActiveTab(activeLink) {
            document.querySelectorAll('.tab-link').forEach(link => {
                link.classList.remove('active');
            });
            activeLink.classList.add('active');
        }
        
        // Initialize everything
        document.addEventListener('DOMContentLoaded', () => {
            updateProgressBar();
            loadSectionQuizzes();
            initializeNavigation();
            
            if (!window.location.hash) {
                router.navigateTo(CHAPTER_ID, 'introduction');
            }
        });
        
        window.addEventListener('progress-changed', updateProgressBar);
    </script>
</body>
</html>
