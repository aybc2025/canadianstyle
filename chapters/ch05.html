<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 5: Numerical Expressions - The Canadian Style</title>
    <link rel="stylesheet" href="../shared/css/main.css">
    <link rel="stylesheet" href="../shared/css/quiz-styles.css">
</head>
<body>
    <div class="chapter-container">
        <header class="chapter-header">
            <div class="breadcrumb">
                <a href="../index.html" class="breadcrumb-link">← Dashboard</a>
                <span class="breadcrumb-separator">/</span>
                <span class="breadcrumb-current">Chapter 5: Numerical Expressions</span>
            </div>
            <div class="chapter-progress">
                <div class="progress-bar">
                    <div class="progress-fill" id="chapterProgress"></div>
                </div>
                <span class="progress-text">Progress</span>
            </div>
        </header>

        <nav class="chapter-nav">
            <div class="nav-links">
                <a href="#introduction" class="tab-link active" data-section="introduction">5.01 Introduction</a>
                <a href="#round-numbers" class="tab-link" data-section="round-numbers">5.02 Round Numbers</a>
                <a href="#consistency" class="tab-link" data-section="consistency">5.03 Consistency</a>
                <a href="#initial" class="tab-link" data-section="initial">5.04 Initial Numbers</a>
                <a href="#quantities" class="tab-link" data-section="quantities">5.05 Quantities</a>
                <a href="#money" class="tab-link" data-section="money">5.06 Money</a>
                <a href="#percentages" class="tab-link" data-section="percentages">5.07 Percentages</a>
                <a href="#time" class="tab-link" data-section="time">5.08 Time</a>
                <a href="#dates" class="tab-link" data-section="dates">5.09 Dates</a>
            </div>
        </nav>

        <main class="chapter-content">
            <!-- Introduction Section -->
            <section class="content-section" id="introduction">
                <div class="section-header">
                    <h2>5.01 Introduction to Numerical Expressions</h2>
                </div>
                
                <div class="content-block">
                    <p>Consistency in expressing numbers enhances readability and professionalism. This chapter covers Canadian government standards for writing numbers, quantities, money, and time expressions.</p>
                    
                    <div class="key-principles">
                        <h3>Basic Principles</h3>
                        <ul>
                            <li>Be consistent within documents</li>
                            <li>Consider your audience and context</li>
                            <li>Use words for emphasis or formality</li>
                            <li>Use figures for precision and technical writing</li>
                        </ul>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>General Rules</h4>
                            <ul>
                                <li><strong>Spell out:</strong> one to nine</li>
                                <li><strong>Use figures:</strong> 10 and above</li>
                                <li><strong>Spell out:</strong> numbers beginning sentences</li>
                                <li><strong>Be consistent:</strong> within related groups</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Exceptions</h4>
                            <ul>
                                <li><strong>Always figures:</strong> dates, addresses, technical data</li>
                                <li><strong>Always words:</strong> approximate numbers, formal writing</li>
                                <li><strong>Mixed:</strong> "3 million" (easier to read)</li>
                                <li><strong>Legal:</strong> spell out for emphasis</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Panel for Introduction -->
                <div class="quiz-panel" id="quiz-introduction"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('introduction')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Round Numbers Section -->
            <section class="content-section" id="round-numbers" style="display: none;">
                <div class="section-header">
                    <h2>5.02 Round Numbers</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Expressing Round Numbers</h4>
                        <p>Round numbers can often be expressed more clearly using words combined with figures.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Large Round Numbers</h4>
                            <ul>
                                <li><strong>Preferred:</strong> 3 million</li>
                                <li><strong>Not:</strong> 3,000,000</li>
                                <li><strong>Preferred:</strong> 2.5 billion</li>
                                <li><strong>Not:</strong> 2,500,000,000</li>
                                <li><strong>Preferred:</strong> 150 thousand</li>
                                <li><strong>Not:</strong> 150,000</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Approximations</h4>
                            <ul>
                                <li><strong>Words:</strong> about fifty people</li>
                                <li><strong>Words:</strong> several hundred applications</li>
                                <li><strong>Words:</strong> thousands of responses</li>
                                <li><strong>Words:</strong> dozens of options</li>
                                <li><strong>Figures:</strong> approximately 50 people</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Scientific Notation</h4>
                        <p>For very large or small numbers in technical contexts, use scientific notation: 1.5 × 10⁶ or 1.5E+06</p>
                    </div>
                </div>
                
                <!-- Quiz Panel for Round Numbers -->
                <div class="quiz-panel" id="quiz-round-numbers"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('round-numbers')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Consistency Section -->
            <section class="content-section" id="consistency" style="display: none;">
                <div class="section-header">
                    <h2>5.03 Consistency</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Consistency Rules</h4>
                        <p>When numbers in a series include both small and large values, treat them consistently.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Consistent Series</h4>
                            <ul>
                                <li><strong>Correct:</strong> We received 3, 15, and 127 applications</li>
                                <li><strong>Incorrect:</strong> We received three, 15, and 127 applications</li>
                                <li><strong>Correct:</strong> The groups had 8, 12, and 145 members</li>
                                <li><strong>Incorrect:</strong> The groups had eight, 12, and 145 members</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Separate Categories</h4>
                            <ul>
                                <li>Five departments submitted 127 proposals</li>
                                <li>Each of the three offices has 15 staff</li>
                                <li>Two programs serve 1,200 clients</li>
                                <li>Eight regions reported 45 incidents</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Different Contexts</h4>
                        <p>Numbers can be treated differently when they serve different purposes in the same sentence, but consistency within each purpose is important.</p>
                    </div>
                </div>
                
                <!-- Quiz Panel for Consistency -->
                <div class="quiz-panel" id="quiz-consistency"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('consistency')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Initial Numbers Section -->
            <section class="content-section" id="initial" style="display: none;">
                <div class="section-header">
                    <h2>5.04 Initial Numbers</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Numbers Beginning Sentences</h4>
                        <p>Always spell out numbers that begin sentences, or rework the sentence.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Correct Examples</h4>
                            <ul>
                                <li><strong>Spelled out:</strong> Fifteen people attended</li>
                                <li><strong>Reworded:</strong> The meeting had 15 attendees</li>
                                <li><strong>Spelled out:</strong> One hundred and fifty applications were received</li>
                                <li><strong>Reworded:</strong> We received 150 applications</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Avoid These</h4>
                            <ul>
                                <li>❌ 15 people attended</li>
                                <li>❌ 150 applications were received</li>
                                <li>❌ 2024 was a good year</li>
                                <li>❌ 3 million people live there</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Large Numbers</h4>
                        <p>For very large numbers at sentence beginnings, rewording is usually better than spelling out the entire number.</p>
                        <ul>
                            <li><strong>Better:</strong> The budget totals $1.5 million</li>
                            <li><strong>Not:</strong> One million five hundred thousand dollars is the budget</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Quiz Panel for Initial Numbers -->
                <div class="quiz-panel" id="quiz-initial"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('initial')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Quantities Section -->
            <section class="content-section" id="quantities" style="display: none;">
                <div class="section-header">
                    <h2>5.05 Quantities and Measurements</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Units of Measurement</h4>
                        <p>Use figures with units of measurement, and abbreviate units in technical writing.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Metric Units</h4>
                            <ul>
                                <li>5 kg (kilograms)</li>
                                <li>120 km (kilometres)</li>
                                <li>25°C (degrees Celsius)</li>
                                <li>500 mL (millilitres)</li>
                                <li>2.5 cm (centimetres)</li>
                                <li>1,000 m² (square metres)</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Spelled Out Forms</h4>
                            <ul>
                                <li>five kilograms of material</li>
                                <li>120 kilometres from the city</li>
                                <li>a temperature of 25 degrees Celsius</li>
                                <li>500 millilitres of solution</li>
                                <li>measured 2.5 centimetres</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Age and Dimensions</h4>
                        <ul>
                            <li><strong>Ages:</strong> a 5-year-old child, children aged 5 to 12</li>
                            <li><strong>Dimensions:</strong> 3 × 5 metres, a 30- by 40-centimetre frame</li>
                            <li><strong>Ranges:</strong> 15 to 20 people, 10–15 minutes</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Quiz Panel for Quantities -->
                <div class="quiz-panel" id="quiz-quantities"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('quantities')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Money Section -->
            <section class="content-section" id="money" style="display: none;">
                <div class="section-header">
                    <h2>5.06 Money</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Currency Expressions</h4>
                        <p>Use the dollar sign with figures, and be consistent with decimal places.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Standard Format</h4>
                            <ul>
                                <li>$5 (not $5.00 in running text)</li>
                                <li>$5.25 (when cents are needed)</li>
                                <li>$1,500 (use commas for thousands)</li>
                                <li>$2.5 million (large round amounts)</li>
                                <li>$1.25 billion</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Special Cases</h4>
                            <ul>
                                <li><strong>Tables:</strong> Always use $0.00 format</li>
                                <li><strong>Cents only:</strong> 25¢ or 25 cents</li>
                                <li><strong>Foreign:</strong> US$100, £50, €75</li>
                                <li><strong>Historical:</strong> specify currency if unclear</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Ranges and Estimates</h4>
                        <ul>
                            <li><strong>Ranges:</strong> $500 to $750, $500–$750</li>
                            <li><strong>Estimates:</strong> approximately $1 million</li>
                            <li><strong>Maximum:</strong> up to $2,500</li>
                            <li><strong>Minimum:</strong> at least $100</li>
                        </ul>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Formal/Legal Writing</h4>
                            <ul>
                                <li>five thousand dollars ($5,000)</li>
                                <li>twenty-five hundred dollars ($2,500)</li>
                                <li>one million dollars ($1,000,000)</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Budget Documents</h4>
                            <ul>
                                <li>$125.5K (thousands)</li>
                                <li>$2.5M (millions)</li>
                                <li>$1.2B (billions)</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Panel for Money -->
                <div class="quiz-panel" id="quiz-money"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('money')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Percentages Section -->
            <section class="content-section" id="percentages" style="display: none;">
                <div class="section-header">
                    <h2>5.07 Percentages</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Percentage Format</h4>
                        <p>Use figures with percentages, and choose between "%" and "per cent" based on context.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Technical/Statistical Writing</h4>
                            <ul>
                                <li>25% of respondents</li>
                                <li>3.5% increase</li>
                                <li>0.5% margin of error</li>
                                <li>100% completion rate</li>
                                <li>15.7% annual growth</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Formal/General Writing</h4>
                            <ul>
                                <li>25 per cent of respondents</li>
                                <li>3.5 per cent increase</li>
                                <li>0.5 per cent margin of error</li>
                                <li>100 per cent completion</li>
                                <li>15.7 per cent annual growth</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Special Cases</h4>
                        <ul>
                            <li><strong>Beginning sentences:</strong> "Twenty-five per cent of..."</li>
                            <li><strong>Ranges:</strong> 15% to 20% or 15 to 20 per cent</li>
                            <li><strong>Approximations:</strong> about 15 per cent</li>
                            <li><strong>Fractions:</strong> one-half of one per cent (0.5%)</li>
                        </ul>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Common Expressions</h4>
                            <ul>
                                <li>percentage point (not percent point)</li>
                                <li>percentage increase/decrease</li>
                                <li>by 5 percentage points</li>
                                <li>from 10% to 15% (5 percentage points)</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Avoid</h4>
                            <ul>
                                <li>❌ 25 % (space before %)</li>
                                <li>❌ 25percent (no space)</li>
                                <li>❌ twenty-five % (mixed)</li>
                                <li>❌ percents (as plural noun)</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Panel for Percentages -->
                <div class="quiz-panel" id="quiz-percentages"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('percentages')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Time Section -->
            <section class="content-section" id="time" style="display: none;">
                <div class="section-header">
                    <h2>5.08 Time</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Time Expressions</h4>
                        <p>Use figures for specific times and words for general time references.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Specific Times</h4>
                            <ul>
                                <li>9:00 a.m. (or 9 a.m.)</li>
                                <li>2:30 p.m.</li>
                                <li>12:00 noon (or noon)</li>
                                <li>12:00 midnight (or midnight)</li>
                                <li>24-hour format: 14:30, 09:00</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>General References</h4>
                            <ul>
                                <li>half past two</li>
                                <li>quarter to three</li>
                                <li>early morning</li>
                                <li>late afternoon</li>
                                <li>in the evening</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Duration and Periods</h4>
                        <ul>
                            <li><strong>Duration:</strong> 2 hours 30 minutes, 2.5 hours</li>
                            <li><strong>Age/Period:</strong> a 10-minute break, 5-year plan</li>
                            <li><strong>Ranges:</strong> 9:00 a.m. to 5:00 p.m., 9 a.m.–5 p.m.</li>
                        </ul>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Time Zones</h4>
                            <ul>
                                <li>2:00 p.m. EST</li>
                                <li>9:00 a.m. PST</li>
                                <li>14:00 UTC</li>
                                <li>3:00 p.m. Atlantic time</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Avoid</h4>
                            <ul>
                                <li>❌ 2:00 p.m. in the afternoon</li>
                                <li>❌ 9:00 a.m. in the morning</li>
                                <li>❌ 12:00 a.m. midnight</li>
                                <li>❌ 12:00 p.m. noon</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Panel for Time -->
                <div class="quiz-panel" id="quiz-time"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('time')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Dates Section -->
            <section class="content-section" id="dates" style="display: none;">
                <div class="section-header">
                    <h2>5.09 Dates</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Date Formats</h4>
                        <p>Canadian government writing uses several acceptable date formats depending on context.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Standard Formats</h4>
                            <ul>
                                <li><strong>Full:</strong> January 15, 2025</li>
                                <li><strong>Short:</strong> Jan. 15, 2025</li>
                                <li><strong>Numeric:</strong> 2025-01-15 (ISO format)</li>
                                <li><strong>Numeric:</strong> 15/01/2025 (day/month/year)</li>
                                <li><strong>No year:</strong> January 15</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Decades and Centuries</h4>
                            <ul>
                                <li><strong>Decades:</strong> the 1990s, the nineties</li>
                                <li><strong>Centuries:</strong> the 21st century</li>
                                <li><strong>Years:</strong> the year 2000, Y2K</li>
                                <li><strong>Fiscal:</strong> fiscal year 2024–25, FY 2024-25</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="rule-box">
                        <h4>Special Considerations</h4>
                        <ul>
                            <li><strong>Avoid:</strong> 01/15/2025 (ambiguous month/day order)</li>
                            <li><strong>International:</strong> Use ISO format (2025-01-15) for clarity</li>
                            <li><strong>All-numeric:</strong> Specify format when ambiguity possible</li>
                        </ul>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Date Ranges</h4>
                            <ul>
                                <li>January 15 to 20, 2025</li>
                                <li>January 15–20, 2025</li>
                                <li>January 15, 2024, to March 1, 2025</li>
                                <li>2024–2025 academic year</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Historical Dates</h4>
                            <ul>
                                <li>July 1, 1867 (Confederation)</li>
                                <li>the 1960s</li>
                                <li>early 2000s</li>
                                <li>mid-1990s</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Panel for Dates -->
                <div class="quiz-panel" id="quiz-dates"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('dates')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Include JavaScript modules -->
    <script type="module" src="../shared/js/router.js"></script>
    <script type="module" src="../shared/js/quiz-engine.js"></script>
    <script type="module" src="../shared/js/progress.js"></script>
    <script type="module" src="../shared/js/components.js"></script>

    <script type="module">
        import { router } from '../shared/js/router.js';
        import { getChapterProgress, setProgress } from '../shared/js/progress.js';
        import { QuizEngine } from '../shared/js/quiz-engine.js';
        
        const CHAPTER_ID = 'ch05';
        const sections = [
            { id: 'introduction', title: '5.01 Introduction' },
            { id: 'round-numbers', title: '5.02 Round Numbers' },
            { id: 'consistency', title: '5.03 Consistency' },
            { id: 'initial', title: '5.04 Initial Numbers' },
            { id: 'quantities', title: '5.05 Quantities' },
            { id: 'money', title: '5.06 Money' },
            { id: 'percentages', title: '5.07 Percentages' },
            { id: 'time', title: '5.08 Time' },
            { id: 'dates', title: '5.09 Dates' }
        ];
        
        // Initialize router
        router.init(CHAPTER_ID, sections);
        
        // Update progress bar using correct API
        function updateProgressBar() {
            const chapterProgress = getChapterProgress(CHAPTER_ID);
            const completed = Object.values(chapterProgress).filter(Boolean).length;
            const percentage = Math.round((completed / sections.length) * 100);
            
            const progressBar = document.getElementById('chapterProgress');
            if (progressBar) {
                progressBar.style.width = percentage + '%';
            }
        }
        
        // Mark section as complete
        window.completeSection = function(sectionId) {
            setProgress(CHAPTER_ID, sectionId, true);
            updateProgressBar();
            
            // Navigate to next section
            const currentIndex = sections.findIndex(s => s.id === sectionId);
            if (currentIndex < sections.length - 1) {
                const nextSection = sections[currentIndex + 1];
                router.navigateTo(CHAPTER_ID, nextSection.id);
            } else {
                // Chapter complete
                showCompletionModal();
            }
        };
        
        function showCompletionModal() {
            const modal = document.createElement('div');
            modal.className = 'completion-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <h3>🎉 Chapter 5 Complete!</h3>
                    <p>You've mastered numerical expressions. Ready for the next chapter?</p>
                    <div class="modal-actions">
                        <button class="btn btn-outline" onclick="this.closest('.completion-modal').remove()">
                            Stay Here
                        </button>
                        <a href="../index.html" class="btn btn-primary">
                            Back to Dashboard
                        </a>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        // Load section quizzes - FIXED VERSION
        async function loadSectionQuizzes() {
            // Sample quiz data - in real implementation, this would come from JSON files
            const quizData = {
                introduction: {
                    title: 'Introduction to Numbers',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'What is the basic rule for expressing numbers 1–9?',
                            options: [
                                { label: 'Always use figures', correct: false },
                                { label: 'Spell them out', correct: true },
                                { label: 'Use either figures or words', correct: false },
                                { label: 'Depends on context only', correct: false }
                            ],
                            rationale: 'Canadian style generally spells out numbers one to nine.',
                            ref: '§5.01'
                        }
                    ]
                },
                'round-numbers': {
                    title: 'Round Numbers',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'How should "3,000,000" be written for better readability?',
                            options: [
                                { label: '3,000,000', correct: false },
                                { label: '3 million', correct: true },
                                { label: 'three million', correct: false },
                                { label: '3M', correct: false }
                            ],
                            rationale: 'Large round numbers are clearer when expressed as "3 million" rather than all figures.',
                            ref: '§5.02'
                        }
                    ]
                },
                consistency: {
                    title: 'Consistency',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'How should this be written: "We received [three/3], [15], and [127] applications"?',
                            options: [
                                { label: 'three, 15, and 127', correct: false },
                                { label: '3, 15, and 127', correct: true },
                                { label: 'three, fifteen, and 127', correct: false },
                                { label: 'Mix styles as appropriate', correct: false }
                            ],
                            rationale: 'When numbers appear in a series, treat them consistently.',
                            ref: '§5.03'
                        }
                    ]
                },
                initial: {
                    title: 'Initial Numbers',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'How should "15 people attended" be written when starting a sentence?',
                            options: [
                                { label: '15 people attended', correct: false },
                                { label: 'Fifteen people attended', correct: true },
                                { label: 'The meeting had 15 attendees', correct: true },
                                { label: 'Both B and C are correct', correct: true }
                            ],
                            rationale: 'Numbers beginning sentences must be spelled out, or rework the sentence.',
                            ref: '§5.04'
                        }
                    ]
                },
                quantities: {
                    title: 'Quantities',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'Which is correct for measurements?',
                            options: [
                                { label: 'five kg', correct: false },
                                { label: '5 kg', correct: true },
                                { label: '5kg', correct: false },
                                { label: '5 kilograms', correct: false }
                            ],
                            rationale: 'Use figures with abbreviated units of measurement.',
                            ref: '§5.05'
                        }
                    ]
                },
                money: {
                    title: 'Money',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'How should five dollars be written in running text?',
                            options: [
                                { label: '$5.00', correct: false },
                                { label: '$5', correct: true },
                                { label: 'five dollars', correct: false },
                                { label: '$5.0', correct: false }
                            ],
                            rationale: 'In running text, use $5 not $5.00 for whole dollar amounts.',
                            ref: '§5.06'
                        }
                    ]
                },
                percentages: {
                    title: 'Percentages',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'Which percentage format is preferred in formal Canadian government writing?',
                            options: [
                                { label: '25%', correct: false },
                                { label: '25 per cent', correct: true },
                                { label: '25 percent', correct: false },
                                { label: 'twenty-five %', correct: false }
                            ],
                            rationale: 'Canadian government style prefers "per cent" in formal writing.',
                            ref: '§5.07'
                        }
                    ]
                },
                time: {
                    title: 'Time',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'Which time expression is redundant?',
                            options: [
                                { label: '2:00 p.m.', correct: false },
                                { label: '2:00 p.m. in the afternoon', correct: true },
                                { label: 'two o\'clock', correct: false },
                                { label: '14:00', correct: false }
                            ],
                            rationale: 'Avoid "p.m. in the afternoon" - p.m. already indicates afternoon.',
                            ref: '§5.08'
                        }
                    ]
                },
                dates: {
                    title: 'Dates',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'Which date format should be avoided for international communication?',
                            options: [
                                { label: '2025-01-15', correct: false },
                                { label: 'January 15, 2025', correct: false },
                                { label: '01/15/2025', correct: true },
                                { label: '15 January 2025', correct: false }
                            ],
                            rationale: 'Avoid ambiguous formats like 01/15/2025 where month/day order is unclear.',
                            ref: '§5.09'
                        }
                    ]
                }
            };
            
            // Initialize quizzes using FIXED API
            for (const section of sections) {
                const quiz = quizData[section.id];
                if (quiz) {
                    const container = document.getElementById(`quiz-${section.id}`);
                    if (container) {
                        // FIXED: Use correct constructor parameters
                        const engine = new QuizEngine(quiz, CHAPTER_ID, section.id);
                        const quizElement = engine.render();
                        container.appendChild(quizElement);
                    }
                }
            }
        }
        
        // Initialize navigation
        function initializeNavigation() {
            document.querySelectorAll('.tab-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const sectionId = link.dataset.section;
                    showSection(sectionId);
                    updateActiveTab(link);
                });
            });
        }
        
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Show target section
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.style.display = 'block';
            }
        }
        
        function updateActiveTab(activeLink) {
            document.querySelectorAll('.tab-link').forEach(link => {
                link.classList.remove('active');
            });
            activeLink.classList.add('active');
        }
        
        // Initialize everything
        document.addEventListener('DOMContentLoaded', () => {
            updateProgressBar();
            loadSectionQuizzes();
            initializeNavigation();
            
            if (!window.location.hash) {
                router.navigateTo(CHAPTER_ID, 'introduction');
            }
        });
        
        window.addEventListener('progress-changed', updateProgressBar);
    </script>
</body>
</html>
