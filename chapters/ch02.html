<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 2: Hyphenation - The Canadian Style</title>
    <link rel="stylesheet" href="../shared/css/main.css">
    <link rel="stylesheet" href="../shared/css/quiz-styles.css">
</head>
<body>
    <div class="chapter-container">
        <header class="chapter-header">
            <div class="breadcrumb">
                <a href="../index.html" class="breadcrumb-link">← Dashboard</a>
                <span class="breadcrumb-separator">/</span>
                <span class="breadcrumb-current">Chapter 2: Hyphenation</span>
            </div>
            <div class="chapter-progress">
                <div class="progress-bar">
                    <div class="progress-fill" id="chapterProgress"></div>
                </div>
                <span class="progress-text">Progress</span>
            </div>
        </header>

        <nav class="chapter-nav">
            <div class="nav-links">
                <a href="#introduction" class="tab-link active" data-section="introduction">2.01 Introduction</a>
                <a href="#compound-words" class="tab-link" data-section="compound-words">2.02 Compound Words</a>
                <a href="#prefixes" class="tab-link" data-section="prefixes">2.07 Prefixes</a>
                <a href="#word-division" class="tab-link" data-section="word-division">2.13 Word Division</a>
                <a href="#special-cases" class="tab-link" data-section="special-cases">2.15 Special Cases</a>
                <a href="#technical-terms" class="tab-link" data-section="technical-terms">2.17 Technical Terms</a>
            </div>
        </nav>

        <main class="chapter-content">
            <!-- Introduction Section -->
            <section class="content-section" id="introduction">
                <div class="section-header">
                    <h2>2.01 Introduction to Hyphenation</h2>
                </div>
                
                <div class="content-block">
                    <p>Hyphenation rules help us combine words clearly and divide words properly at line breaks. This chapter covers compound words, prefixes, and word division guidelines following Canadian government standards.</p>
                    
                    <div class="key-principles">
                        <h3>Key Principles</h3>
                        <ul>
                            <li>Hyphens join words to create new meanings</li>
                            <li>They prevent misreading and ambiguity</li>
                            <li>Usage evolves from hyphenated to one word</li>
                            <li>Consult current dictionaries for guidance</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Quiz Panel for Introduction -->
                <div class="quiz-panel" id="quiz-introduction"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('introduction')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Compound Words Section -->
            <section class="content-section" id="compound-words" style="display: none;">
                <div class="section-header">
                    <h2>2.02 Compound Words</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Basic Rules</h4>
                        <p>Compound words can be:</p>
                        <ul>
                            <li><strong>Open:</strong> post office, prime minister</li>
                            <li><strong>Hyphenated:</strong> part-time, twenty-one</li>
                            <li><strong>Closed:</strong> nationwide, bookkeeper</li>
                        </ul>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Adjective Compounds</h4>
                            <ul>
                                <li>well-known author</li>
                                <li>high-speed train</li>
                                <li>part-time worker</li>
                                <li>up-to-date information</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Numbers</h4>
                            <ul>
                                <li>twenty-one to ninety-nine</li>
                                <li>one-third, two-thirds</li>
                                <li>twenty-first century</li>
                                <li>fifty-fifty chance</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Panel for Compound Words -->
                <div class="quiz-panel" id="quiz-compound-words"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('compound-words')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Prefixes Section -->
            <section class="content-section" id="prefixes" style="display: none;">
                <div class="section-header">
                    <h2>2.07 Prefixes</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Hyphenate With Prefixes When:</h4>
                        <ul>
                            <li>Before proper nouns: <em>anti-Canadian, pro-European</em></li>
                            <li>Before capitals: <em>pre-Confederation, post-WWII</em></li>
                            <li>With ex- meaning former: <em>ex-president, ex-wife</em></li>
                            <li>To avoid confusion: <em>re-cover vs. recover</em></li>
                        </ul>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Common Prefixes</h4>
                            <ul>
                                <li><strong>anti-:</strong> anti-war, anti-virus</li>
                                <li><strong>co-:</strong> co-worker, co-operate</li>
                                <li><strong>ex-:</strong> ex-minister, ex-employee</li>
                                <li><strong>non-:</strong> non-profit, non-violent</li>
                                <li><strong>pre-:</strong> pre-school, pre-war</li>
                                <li><strong>re-:</strong> re-examine, re-enter</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>No Hyphen Needed</h4>
                            <ul>
                                <li>multicoloured</li>
                                <li>overestimate</li>
                                <li>underemployed</li>
                                <li>international</li>
                                <li>extraordinary</li>
                                <li>semiconductor</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Panel for Prefixes -->
                <div class="quiz-panel" id="quiz-prefixes"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('prefixes')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Word Division Section -->
            <section class="content-section" id="word-division" style="display: none;">
                <div class="section-header">
                    <h2>2.13 Word Division</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Basic Rules for Line Breaks</h4>
                        <ul>
                            <li>Divide between syllables</li>
                            <li>Keep at least 2 letters on each line</li>
                            <li>Don't divide one-syllable words</li>
                            <li>Avoid dividing proper names</li>
                        </ul>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Correct Divisions</h4>
                            <ul>
                                <li>gov-ern-ment</li>
                                <li>Cana-dian</li>
                                <li>admin-is-tra-tion</li>
                                <li>impor-tant</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Avoid These</h4>
                            <ul>
                                <li>❌ a-bout (too few letters)</li>
                                <li>❌ through (one syllable)</li>
                                <li>❌ Otta-wa (proper name)</li>
                                <li>❌ e-mail (too few letters)</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Panel for Word Division -->
                <div class="quiz-panel" id="quiz-word-division"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('word-division')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Special Cases Section -->
            <section class="content-section" id="special-cases" style="display: none;">
                <div class="section-header">
                    <h2>2.15 Special Cases</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Special Hyphenation Rules</h4>
                        <p>Some words require special attention beyond the basic rules.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Suspended Hyphens</h4>
                            <p>When several compounds share a common element:</p>
                            <ul>
                                <li>two- and three-year terms</li>
                                <li>pre- and post-war periods</li>
                                <li>first-, second-, and third-class mail</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Temporary Compounds</h4>
                            <p>Created for specific contexts:</p>
                            <ul>
                                <li>state-of-the-art technology</li>
                                <li>matter-of-fact approach</li>
                                <li>behind-the-scenes work</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Panel for Special Cases -->
                <div class="quiz-panel" id="quiz-special-cases"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('special-cases')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>

            <!-- Technical Terms Section -->
            <section class="content-section" id="technical-terms" style="display: none;">
                <div class="section-header">
                    <h2>2.17 Technical Terms</h2>
                </div>
                
                <div class="content-block">
                    <div class="rule-box">
                        <h4>Technical and Scientific Terms</h4>
                        <p>Technical fields often have specific hyphenation conventions.</p>
                    </div>
                    
                    <div class="examples-grid">
                        <div class="example-item">
                            <h4>Scientific Terms</h4>
                            <ul>
                                <li>X-ray, Y-axis</li>
                                <li>T-shirt, I-beam</li>
                                <li>alpha-particle</li>
                                <li>beta-testing</li>
                            </ul>
                        </div>
                        
                        <div class="example-item">
                            <h4>Government Terms</h4>
                            <ul>
                                <li>Governor-in-Council</li>
                                <li>Attorney-General</li>
                                <li>Secretary-General</li>
                                <li>Commander-in-Chief</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Panel for Technical Terms -->
                <div class="quiz-panel" id="quiz-technical-terms"></div>
                
                <div class="section-footer">
                    <button class="btn btn-primary" onclick="completeSection('technical-terms')">
                        Mark Complete & Continue
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Include JavaScript modules -->
    <script type="module" src="../shared/js/router.js"></script>
    <script type="module" src="../shared/js/quiz-engine.js"></script>
    <script type="module" src="../shared/js/progress.js"></script>
    <script type="module" src="../shared/js/components.js"></script>

    <script type="module">
        import { router } from '../shared/js/router.js';
        import { getChapterProgress, setProgress } from '../shared/js/progress.js';
        import { QuizEngine } from '../shared/js/quiz-engine.js';
        
        const CHAPTER_ID = 'ch02';
        const sections = [
            { id: 'introduction', title: '2.01 Introduction' },
            { id: 'compound-words', title: '2.02 Compound Words' },
            { id: 'prefixes', title: '2.07 Prefixes' },
            { id: 'word-division', title: '2.13 Word Division' },
            { id: 'special-cases', title: '2.15 Special Cases' },
            { id: 'technical-terms', title: '2.17 Technical Terms' }
        ];
        
        // Initialize router
        router.init(CHAPTER_ID, sections);
        
        // Update progress bar using correct API
        function updateProgressBar() {
            const chapterProgress = getChapterProgress(CHAPTER_ID);
            const completed = Object.values(chapterProgress).filter(Boolean).length;
            const percentage = Math.round((completed / sections.length) * 100);
            
            const progressBar = document.getElementById('chapterProgress');
            if (progressBar) {
                progressBar.style.width = percentage + '%';
            }
        }
        
        // Mark section as complete
        window.completeSection = function(sectionId) {
            setProgress(CHAPTER_ID, sectionId, true);
            updateProgressBar();
            
            // Navigate to next section
            const currentIndex = sections.findIndex(s => s.id === sectionId);
            if (currentIndex < sections.length - 1) {
                const nextSection = sections[currentIndex + 1];
                router.navigateTo(CHAPTER_ID, nextSection.id);
            } else {
                // Chapter complete
                showCompletionModal();
            }
        };
        
        function showCompletionModal() {
            const modal = document.createElement('div');
            modal.className = 'completion-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <h3>🎉 Chapter 2 Complete!</h3>
                    <p>You've mastered hyphenation rules. Ready for the next chapter?</p>
                    <div class="modal-actions">
                        <button class="btn btn-outline" onclick="this.closest('.completion-modal').remove()">
                            Stay Here
                        </button>
                        <a href="../index.html" class="btn btn-primary">
                            Back to Dashboard
                        </a>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        // Load section quizzes - FIXED VERSION
        async function loadSectionQuizzes() {
            // Sample quiz data - in real implementation, this would come from JSON files
            const quizData = {
                introduction: {
                    title: 'Introduction to Hyphenation',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'What is the main purpose of hyphens?',
                            options: [
                                { label: 'To make words longer', correct: false },
                                { label: 'To join words and prevent confusion', correct: true },
                                { label: 'To replace periods', correct: false },
                                { label: 'To indicate pauses', correct: false }
                            ],
                            rationale: 'Hyphens join words to create new meanings and prevent misreading.',
                            ref: '§2.01'
                        }
                    ]
                },
                'compound-words': {
                    title: 'Compound Words',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'How should "part time worker" be written when used as an adjective?',
                            options: [
                                { label: 'part time worker', correct: false },
                                { label: 'part-time worker', correct: true },
                                { label: 'parttime worker', correct: false },
                                { label: 'part_time worker', correct: false }
                            ],
                            rationale: 'Compound adjectives before nouns are typically hyphenated.',
                            ref: '§2.02'
                        }
                    ]
                },
                prefixes: {
                    title: 'Prefixes',
                    questions: [
                        {
                            type: 'fill-blank',
                            stem: 'How should you write "former president"?',
                            answer: 'ex-president',
                            rationale: 'Always hyphenate "ex-" when meaning former.',
                            ref: '§2.07'
                        }
                    ]
                },
                'word-division': {
                    title: 'Word Division',
                    questions: [
                        {
                            type: 'true-false',
                            stem: 'You can divide any word at the end of a line.',
                            correct: false,
                            rationale: 'Words must be divided between syllables, and one-syllable words cannot be divided.',
                            ref: '§2.13'
                        }
                    ]
                },
                'special-cases': {
                    title: 'Special Cases',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'How should you write "state of the art technology"?',
                            options: [
                                { label: 'state of the art technology', correct: false },
                                { label: 'state-of-the-art technology', correct: true },
                                { label: 'state of the-art technology', correct: false },
                                { label: 'stateoftheart technology', correct: false }
                            ],
                            rationale: 'Temporary compounds used as adjectives are fully hyphenated.',
                            ref: '§2.15'
                        }
                    ]
                },
                'technical-terms': {
                    title: 'Technical Terms',
                    questions: [
                        {
                            type: 'mcq',
                            stem: 'Which is the correct form?',
                            options: [
                                { label: 'Governor in Council', correct: false },
                                { label: 'Governor-in-Council', correct: true },
                                { label: 'GovernorInCouncil', correct: false },
                                { label: 'Governor_in_Council', correct: false }
                            ],
                            rationale: 'Government titles with multiple parts are hyphenated.',
                            ref: '§2.17'
                        }
                    ]
                }
            };
            
            // Initialize quizzes using FIXED API
            for (const section of sections) {
                const quiz = quizData[section.id];
                if (quiz) {
                    const container = document.getElementById(`quiz-${section.id}`);
                    if (container) {
                        // FIXED: Use correct constructor parameters
                        const engine = new QuizEngine(quiz, CHAPTER_ID, section.id);
                        const quizElement = engine.render();
                        container.appendChild(quizElement);
                    }
                }
            }
        }
        
        // Initialize navigation
        function initializeNavigation() {
            document.querySelectorAll('.tab-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const sectionId = link.dataset.section;
                    showSection(sectionId);
                    updateActiveTab(link);
                });
            });
        }
        
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Show target section
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.style.display = 'block';
            }
        }
        
        function updateActiveTab(activeLink) {
            document.querySelectorAll('.tab-link').forEach(link => {
                link.classList.remove('active');
            });
            activeLink.classList.add('active');
        }
        
        // Initialize everything
        document.addEventListener('DOMContentLoaded', () => {
            updateProgressBar();
            loadSectionQuizzes();
            initializeNavigation();
            
            if (!window.location.hash) {
                router.navigateTo(CHAPTER_ID, 'introduction');
            }
        });
        
        window.addEventListener('progress-changed', updateProgressBar);
    </script>
</body>
</html>
